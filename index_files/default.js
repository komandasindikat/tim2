!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a}function r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function n(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))}var i=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function s(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e){return this instanceof o?(this.v=e,this):new o(e)}function c(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof o?Promise.resolve(r.value.v).then(u,l):d(s[0][2],r)}catch(e){d(s[0][3],e)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function d(e,t){e(t),s.shift(),s.length&&c(s[0][0],s[0][1])}}function u(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:o(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function l(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=a(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}Object.create;var d=function(){var t=this,r={exports:this};function i(e){switch(typeof e){case"undefined":return!0;case"string":return""===e.trim();case"number":return isNaN(e);case"object":if(null==e)return!0;if(e.constructor===Object)return 0===Object.keys(e).length;if(Array.isArray(e))return 0===e.length}return!1}t.__esModule=!0,t.isEmpty=i;t.Strings=class{static noWhitespace(e){return e&&"string"==typeof e?e.replace(/\s+/g,""):""}static startWith(e,t){return e?e.substring(0,t.length)===t:e===t}static endsWith(e,t){return e.substring(e.length-t.length,e.length)===t}static isEmpty(e){return null==e||0===e.trim().length}static isLowerCase(e){return e===e.toLowerCase()&&e!==e.toUpperCase()}static isUpperCase(e){return e===e.toUpperCase()&&e!==e.toLowerCase()}static kebabCase(e){return e.replace(/([A-Z][a-z]+)/g,"$1-").toLowerCase().replace(/-$/,"")}};class s{static keys(e){return Object.keys(e)}static values(e){return Object.keys(e).map((t=>e[t]))}static entries(e){return Object.keys(e).map((t=>[t,e[t]]))}static removeEmpty(e){return e&&e.constructor===Object?Object.keys(e).reduce(((t,r)=>{const n=s.removeEmpty(e[r]);return i(n)||(t[r]=n),t}),{}):e}static sort(e){return e?Array.isArray(e)?e.map(s.sort):e.constructor===Object?Object.keys(e).sort().reduce(((t,r)=>{const n=e[r];return t[r]=s.sort(n),t}),{}):e:e}static toLowerCase(e){return"string"==typeof e?e.toLowerCase():Array.isArray(e)?e.map(s.toLowerCase):o((()=>e.constructor===Object))?Object.entries(e).reduce(((e,[t,r])=>(e[t]=s.toLowerCase(r),e)),{}):e}static omit(e,...t){return t.reduce(((e,t)=>(Reflect.deleteProperty(e,t),e)),e)}static pick(e,...t){return t.reduce(((t,r)=>(t[r]=e[r],t)),{})}}t.Objects=s;t.Maps=class{static entries(e){if(e.entries)return e.entries();const t=[];return e.forEach(((e,r)=>{t.push([r,e])})),t}};class a{static from(e){return Array.from(e)}static find(e,t){if(e.find)return e.find(t);const[r]=e.filter(t);return r}static toObject(e){return e.reduce(((e,t)=>(Object.keys(t).forEach((r=>{r in e||(e[r]=t[r])})),e)),{})}static flatten(e){return e.reduce(((e,t)=>e.concat(t)),[])}static flatMap(e,t){return e.flatMap?e.flatMap(t):a.flatten(e.map(t))}static unique(e){return Array.from(new Set(e))}static clean(e){return e.filter(Boolean)}static trim(e){return e.map((e=>e.trim()))}static includes(e,t){return"includes"in e?e.includes(t):-1!==e.indexOf(t)}static last(e){return e[e.length-1]}static safeReverse(e){return e?e.slice().reverse():[]}}t.Arrays=a;function o(e,t){try{const r=e();return void 0===r?t:r}catch(e){return t}}function c(e,t){const r=t.toLowerCase(),n=a.find(Object.keys(e),(e=>e.toLowerCase()===r));if(!n)return;const i=e[n];return"string"==typeof i?i.trim():i}function u(e,...t){if(!e)return[];if(Array.isArray(e))return a.clean(a.flatten(e.map((e=>u(e,...t)))));if("object"==typeof e){const[r,...n]=t,i=c(e,r);return"object"==typeof i?u(i,...n):0===n.length&&Boolean(i)?[i]:[]}return[]}t.Elements=class{static path(e){let t=[e];for(;e.parentElement;)e=e.parentElement,t.push(e);return t}},t.get=o,t.getAsync=function(e,t){return n(this,void 0,void 0,(function*(){try{const r=yield e();return void 0===r?t:r}catch(e){return t}}))},t.getValue=c,t.getAll=u,t.extract=function(e,t){return a.flatten(t.map((t=>a.clean(a.unique(u(e,...t.split(".")))))))};const l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0!==r?r:Function("return this")();function d(e,t,r,n=(e=>e)){const i=[];let s,a=0;for(;null!=(s=e.exec(t));)i.push(n(t.substring(a,s.index))),i.push(r(s)),a=e.lastIndex;return i.push(n(t.substring(a))),i.join("")}function h(e){return e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase()}function p(e){return JSON.stringify(s.sort(e))}t.globalThis=l,t.accumulateMultipleValues=function(e,t,r){const n=e[t];return void 0===n?e[t]=r:Array.isArray(n)?-1==n.indexOf(r)&&n.push(r):e[t]=[n,r],e},t.regexReplace=d,t.titleCase=function(e){return d(/\w+/g,e,(e=>h(e[0])))},t.caseWord=h,t.stableJson=p,t.same=function(e,t){return p(e)===p(t)},t.sameIgnoringCase=function(e,t){return p(s.toLowerCase(e))===p(s.toLowerCase(t))},t.limit=function(e,t){return e.slice(0,t)};const f=/\s+/g;return t.cleanSpaces=function(e){return e.trim().replace(f," ")},t.getClassName=function(e){return o((()=>a.last(e.constructor.name.split("$"))),"")},r.exports}.call({});function h(e,t=!0){return e?(0==e.indexOf("?")&&(e=e.substring(1,e.length)),e.split("&").map((function(e){return e.split("=")})).reduce((function(e,r){const n=r[0],i=r[1];if(!n)return e;const s=i?d.get((()=>decodeURIComponent(i.replace(/\+/g,"%20"))),void 0):i,a=t?function(e){try{return JSON.parse(e)}catch(t){return e}}(s):s;return d.accumulateMultipleValues(e,n,a)}),{})):{}}class p{constructor(e){const t=p.RFC_3986.exec(e);if(!t)throw new Error("Invalid Uri: "+e);const[,,r,,n,i,,s,,a]=t;this.scheme=r,this.authority=n?new f(n):void 0,this.path=i,this.query=s,this.fragment=a}toString(){const e=[];return void 0!==this.scheme&&e.push(this.scheme,":"),void 0!==this.authority&&e.push("//",this.authority.toString()),e.push(this.path),void 0!==this.query&&e.push("?",this.query),void 0!==this.fragment&&e.push("#",this.fragment),e.join("")}get host(){return this.authority&&this.authority.host}get port(){return this.authority&&this.authority.port}get userInfo(){return this.authority&&this.authority.userInfo}}p.RFC_3986=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class f{constructor(e){const t=f.RFC_3986.exec(e);if(!t)throw new Error("Invalid Authority: "+e);const[,r,n,i]=t;this.userInfo=r,this.host=n,this.port=i}toString(){const e=[];return void 0!==this.userInfo&&e.push(this.userInfo,"@"),void 0!==this.host&&e.push(this.host),void 0!==this.port&&e.push(":",this.port),e.join("")}}f.RFC_3986=/(?:([^@]+)@)?([^:]+)(?::([\d]+))?/;var y={};Object.defineProperty(y,"__esModule",{value:!0});var m=(g=void 0,y.cache=g);y.caching=m;var g=function(e,t,r){if("function"!=typeof r.value)throw new Error("@cache can only decorate methods");const n=new WeakMap;return Object.defineProperty(e,t,Object.assign(Object.assign({},r),{value:function(...e){const t=JSON.stringify(e),i=function(e){const t=n.get(e);if(t)return t;const r=new Map;return n.set(e,r),r}(this),s=i.get(t);if(void 0!==s)return s;if(i.has(t))return s;const a=r.value.call(this,...e);return i.set(t,a),a}}))};y.cache=g,m=function(e){const t=new Map;return function(...r){const n=JSON.stringify(r),i=t.get(n);if(void 0!==i)return i;if(t.has(n))return i;const s=e(...r);return t.set(n,s),s}},y.caching=m;var v={};Object.defineProperty(v,"__esModule",{value:!0});var w=(k=void 0,D=v.replace=k,v.lazy=D);function b(e,t,r){return Object.defineProperty(e,t,{value:r})}v.container=w;var k=b;function O(e,t,r){if(void 0===r.get)throw new Error("@lazy can only decorate getter methods");return Object.defineProperty(e,t,Object.assign(Object.assign({},r),{get(){return b(this,t,r.get.call(this))[t]}}))}v.replace=k;var S,A,D=O;function P(e=d.globalThis){return e.triptease=e.triptease||{},e.triptease.onboard=e.triptease.onboard||{},{triptease:e.triptease,onboard:e.triptease.onboard}}function x(e,t){return d.get((()=>t.split(".").reduce(((e,t)=>e[t]),e)))}function j(e){return null==e?S.NotImplemented:"function"==typeof e?e.toString().includes("native code")?S.Native:S.NonNative:S.Native}function T(e,...t){return t.reduce(((t,r)=>(t[r]=j(x(e,r)),t)),{})}v.lazy=D,w=function(e){return Object.keys(e).reduce(((t,r)=>O(t,r,{configurable:!0,get:()=>e[r](t)})),{})},v.container=w,(A=S||(S={})).Native="native",A.NonNative="non-native",A.NotImplemented="not-implemented";class C{static exposeApi(){const e=P(d.globalThis).triptease;e.native||(e.native=C)}static getProperty(e){const t=x(d.globalThis,e);return j(t)!==S.NonNative?t:x(C.window,e)}static get window(){const e=d.globalThis;try{const t=e.document,r=t.querySelector("[name='triptease.native']");if(r)return r.contentWindow;const n=t.createElement("iframe");return n.style.display="none",n.setAttribute("title","blank"),n.setAttribute("aria-hidden","true"),n.setAttribute("name","triptease.native"),t.documentElement.appendChild(n),n.contentWindow}catch(t){return e}}}t([y.cache,r("design:type",Function),r("design:paramtypes",[String]),r("design:returntype",Object)],C,"getProperty",null),t([v.lazy,r("design:type",Object),r("design:paramtypes",[])],C,"window",null);const E=C.getProperty("console.log"),I=C.getProperty("console.error"),N=C.getProperty("console.debug");class L{constructor(e=E,t=I,r=N||E){this.log=e,this.error=t,this.debug=r}}class M{constructor(){this.log=()=>{},this.error=()=>{},this.debug=()=>{}}}const F="triptease-debug";function $(e,t="triptease-debug"){const r=d.get((()=>{var r;return h(null===(r=e.location)||void 0===r?void 0:r.search,!1)[t]}))||d.get((()=>{var r;return h(new p(null===(r=e.location)||void 0===r?void 0:r.originalHref).query,!1)[t]}))||d.get((()=>{var t,r;return null===(r=null===(t=e.process)||void 0===t?void 0:t.env)||void 0===r?void 0:r.DEBUG}))||d.get((()=>{var r;return(null===(r=e.localStorage)||void 0===r?void 0:r.getItem)&&e.localStorage.getItem(t)}))||d.get((()=>{var r;return(null===(r=e.sessionStorage)||void 0===r?void 0:r.getItem)&&e.sessionStorage.getItem(t)}))||"";return d.get((()=>r.substring(0,256)),"")}function R(e){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*");return new RegExp("^"+t+"$")}function K(e,t=d.globalThis){try{const r=function(e){return $(e,F).split(",").map((e=>e.trim()))}(t),n=r.filter((e=>"!"===e[0])).map((e=>e.substr(1)));return n.length>0?!n.some((t=>R(t).test(e))):r.some((t=>"true"===t||R(t).test(e)))}catch(e){return!1}}class q{constructor(e){this.name=e,this.console=new L}debug(e,...t){this.console.debug(`[${this.name}] ${e}`,...t)}log(e,...t){this.console.log(`[${this.name}] ${e}`,...t)}error(e,...t){this.console.error(`[${this.name}] ${e}`,...t)}}function _(e,t=d.globalThis){return K(e,t)?new q(e):new M}var U,B,W,H,z,V,G={};function Y(e){return e&&"object"==typeof e&&e.constructor===Object&&"string"==typeof e["@type"]}function J(e,t){return Y(e)&&t(e["@type"])}function X(e){return J(e,(e=>"LodgingReservation"===e))}function Z(e){return e&&"object"==typeof e&&"string"==typeof e.name&&"string"==typeof e.type&&"string"==typeof e.url}G.isIdentifierSource=function(e){return"object"==typeof e&&"source"in e&&"identifier"in e&&"type"in e},G.isOtherSource=function(e){return"object"==typeof e&&"identifier"in e&&"Other"==e.identifier},G.isStructuredData=Y,G.isStructuredDataType=J,G.isLodgingReservation=X,G.isClientSideApplication=Z,G.PageType=W,(H=W||(U=W={},G.PageType=W,U)).Search="Search",H.RoomsAndRates="RoomsAndRates",H.Confirmation="Confirmation",H.Payment="Payment",H.Group="Group",H.Partial="Partial",H.Unknown="Unknown",G.KernelMode=z,(V=z||(B=z={},G.KernelMode=z,B)).Singleton="Singleton",V.ApplicationHost="ApplicationHost",V.DataSource="DataSource";G.BootstrapName="triptease.onboard.bootstrap";G.KernelHostName="triptease.onboard.kernel-host";function Q(e){return!!e&&("object"==typeof e&&("integrationId"in e||"clientKey"in e||"apiKey"in e||"identifiers"in e||"type"in e))}function ee(e){return!(!e||"object"!=typeof e)&&(e.constructor===Date&&!isNaN(e.getTime()))}function te(e){if(void 0===e||!e.type)return!1;switch(e.type){case W.RoomsAndRates:return re(e);case W.Confirmation:return ne(e);default:return!0}}function re(e){return!(!e||"object"!=typeof e)&&(ee(e.checkin)&&ee(e.checkout)&&"number"==typeof e.adults&&"number"==typeof e.children&&(t=e.rateDetails,Array.isArray(t)&&t.some((e=>e.price>0))||!!e.ratesModified));var t}function ne(e){return!(!e||"object"!=typeof e)&&("string"==typeof e.reference&&"number"==typeof e.price&&"string"==typeof e.currency)}function ie(e){if(void 0===e||!e.type)return!1;switch(e.type){case W.RoomsAndRates:return se(e);case W.Confirmation:return function(e){return!(!e||"object"!=typeof e)&&"string"==typeof e.reference}(e);default:return!1}}function se(e){return!(!e||"object"!=typeof e)&&(Array.isArray(e.rateDetails)&&e.rateDetails.length>0||!!e.ratesModified)}function ae(e){try{const{target:t,method:r}=function(e){const[,t,r]=e.match(ue)||[];return{target:t,method:r}}(e.type);if(t&&r)return!0}catch(e){}return!1}G.KernelName="triptease.onboard.kernel",G.isScrapedIdentifiers=Q;class oe{constructor(e,t,r=ce,n=_("messaging")){this.listener=e,this.target=t,this.allowedOrigins=r,this.logger=n}addListener(e){this.listener&&this.listener.addEventListener("message",(t=>{this.disallowedOrigin(t)||ae(t.data)&&e(t.data,new oe(void 0,t.source||this.target))}))}disallowedOrigin(e){return e.origin&&this.allowedOrigins.length>0&&-1===this.allowedOrigins.indexOf(new p(e.origin).host)}send(e){if(this.target)try{this.target.postMessage(e,"*")}catch(t){this.target.postMessage(JSON.parse(JSON.stringify(e)),"*")}}}const ce=["onboard.triptease.io","localhost"],ue=/^(.*)\.([^.]+)$/;function le(e){const t={};return function(...r){const n=JSON.stringify(r),i=t[n];return void 0!==i?i:t[n]=e(...r)}}C.getProperty("Date");class de{now(){return new Date}}function he(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}class pe{static get(){return d.get((()=>{const e="3976.37119";return"v"+e}),"latest")}}const fe={name:"onboard",version:pe.get()},ye=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}\.\d{3}Z)?$/;function me(e,t,r){if(t(e))return r(e);switch(typeof e){case"undefined":return;case"object":if(null===e)return null;if(Array.isArray(e))return e.map((e=>me(e,t,r)));if(e.constructor===Object)return d.Objects.keys(e).sort().reduce(((n,i)=>{const s=e[i];return n[i]=me(s,t,r),n}),{})}return e}function ge(e){return function(e){return me(e,(e=>"string"==typeof e&&ye.test(e)),(e=>{const t=new Date(e);return isNaN(t.valueOf())?e:t}))}(JSON.parse(e))}class ve{static parse(e){return ge(e)}static stringify(e){return JSON.stringify(this.validate(e))}static validate(e){return me(e,(e=>{const t=typeof e;switch(t){case"undefined":case"string":case"number":case"boolean":return!0;case"object":if(null===e)return!0;if(Array.isArray(e))return!1;if(e.constructor===Object)return!1;if("toJSON"in e)return!0}throw new Error(`Illegal JsonValue: ${t} ${e} `)}),(e=>e))}}class we{static same(e,t){return ve.stringify(e)===ve.stringify(t)}static isSuperset(e,t){return null===e||null===t?we.same(e,t):Array.isArray(e)&&Array.isArray(t)?!(e.length>t.length)&&e.every((e=>t.some((t=>we.isSuperset(e,t))))):d.get((()=>e.constructor===Object))&&d.get((()=>t.constructor===Object))?Object.keys(e).reduce(((r,n)=>r&&we.isSuperset(e[n],t[n])),!0):we.same(e,t)}static compress(e){const t=we.groupValues(e);return this.compressGrouped(t)}static compressGrouped(e){return Object.entries(e).reduce((({shared:e,unique:t},[r,n])=>{if(d.get((()=>n.constructor===Object))){const i=we.compressGrouped(n);Object.keys(i.shared).length>0&&(e[r]=i.shared),i.unique.forEach(((e,n)=>{t[n]=t[n]||{},Object.keys(e).length>0&&(t[n][r]=e)}))}return Array.isArray(n)&&n.forEach(((i,s)=>{t[s]=t[s]||{},1===d.Arrays.unique(n.map((e=>ve.stringify(e)))).length?e[r]=i:void 0!==i&&(t[s][r]=i)})),{shared:e,unique:t}}),{shared:{},unique:[]})}static groupValues(e){const t=Array.from(e.reduce(((e,t)=>Object.keys(t).reduce(((e,t)=>e.add(t)),e)),new Set)),[r,n]=e.reduce(((e,r)=>t.reduce((([e,t],n)=>{const i=r[n];return d.get((()=>i.constructor===Object))?(t[n]=t[n]||[],t[n].push(i)):(e[n]=e[n]||[],e[n].push(i)),[e,t]}),e)),[{},{}]),i=Object.entries(n).reduce(((e,[t,r])=>(e[t]=we.groupValues(r),e)),{});return Object.assign(Object.assign({},r),i)}static decompress(e){return e.unique.map((t=>this.merge(e.shared,t)))}static merge(e,t){return[...Object.keys(e),...Object.keys(t)].reduce(((r,n)=>{const i=e[n],s=t[n];return d.get((()=>i.constructor===Object))&&d.get((()=>s.constructor===Object))?r[n]=we.merge(i,s):r[n]=null!=s?s:i,r}),{})}}function be(e){return{title:e.document.title,locale:e.document.documentElement.lang||e.document.documentElement.getAttribute("xml:lang")||"",url:e.location.href,urlParsed:ke(e.location.href),referrer:e.document.referrer,referrerParsed:ke(e.document.referrer),characterSet:e.document.characterSet,opener:d.get((()=>Boolean(e.opener)),!1)}}function ke(e){if(!e)return{};const{scheme:t,host:r,path:n,query:i,fragment:s}=new p(e);return d.Objects.removeEmpty({scheme:t,host:r,path:n,query:i,queryParsed:h(i,!1),fragment:s})}class Oe{constructor(e,t=new de){this.window=e,this.clock=t;try{this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){this.timezone=""}}buildMessage(e){return n(this,void 0,void 0,(function*(){const t=d.get((()=>this.window.triptease.onboard.bootstrap.identity),{}),r=this.clock.now();return we.merge({createdAt:r,messageId:he(),anonymousId:d.get((()=>t.anonymousId)),userId:d.get((()=>t.userId)),sessionId:d.get((()=>t.sessionId)),domainUserId:d.get((()=>t.domainUserId)),context:{library:fe,userAgent:this.window.navigator.userAgent,locale:this.window.navigator.language,page:be(this.window),screen:{width:this.window.screen.width,height:this.window.screen.height},timezone:this.timezone}},e)}))}}class Se{generate(e){if(void 0!==e)throw new Error("UuidGenerator does not support custom lengths");return he().replace(/-/g,"")}}class Ae{constructor(e,t){this.messaging=e,this.idGenerator=t}get(e,t,r){return(...e)=>n(this,void 0,void 0,(function*(){const r=this.idGenerator.generate(),{payload:n}=yield this.messaging.handle({type:"triptease.onboard.request",requestType:String(t),payload:e,correlationId:r});if((i=n)&&"object"==typeof i&&"name"in i&&"string"==typeof i.name&&"message"in i&&"string"==typeof i.message&&"stack"in i&&"string"==typeof i.stack)throw n;var i;return n}))}}function De(e,t=new Se){return new Proxy({},new Ae(e,t))}class Pe{constructor(e,t=De(e)){this.proxy=t,this.applicationConfig=le((e=>n(this,void 0,void 0,(function*(){return yield this.proxy.applicationConfig(e)})))),this.generateConfig=le((e=>n(this,void 0,void 0,(function*(){return yield this.proxy.generateConfig(e)}))))}}class xe{constructor(e,t){this.providers=e,this.logger=t}scrapeIdentifiers(){return n(this,void 0,void 0,(function*(){return(yield Promise.all(this.providers.map((e=>n(this,void 0,void 0,(function*(){try{return this.clean(yield e.scrapeIdentifiers())}catch(e){return this.logger.error("Scraper threw error, probable identification failure",e),{}}})))))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})}))}clean(e){const t=d.Objects.removeEmpty(e);return t.identifiers&&(t.identifiers=t.identifiers.filter((e=>!!e.identifier)).map((e=>({identifier:e.identifier.toString().trim(),type:e.type,identifierType:e.identifierType}))).filter((e=>!d.Strings.isEmpty(e.identifier)))),t}}function je(e){if(d.Strings.isEmpty(e))return{};if(-1!==e.indexOf(":")){const[t,r]=e.split(":");return{clientKey:t,identifiers:[{identifier:r,type:"Trusted"}]}}return{apiKey:e}}function Te(e){if(!Q(e))return{};const{integrationId:t,clientKey:r,apiKey:n,identifiers:i,type:s}=e,a=je(n);return t&&(a.integrationId=t),r&&(a.clientKey=r),i&&(a.identifiers=i),s&&(a.type=s),a}class Ce{constructor(){this.scripts=[]}static create(e){const t=P(e).onboard,r=t.stackScriptFinder;return r||(t.stackScriptFinder=new Ce)}capture(){const e=function(){try{throw new Error}catch(e){if(!e.stack)return;const t=e.stack.match(Ee);if(!t)return;const r=t[1];return new p(r)}}();e&&this.scripts.push(e)}get(){return this.scripts}}const Ee=/(https?.*):\d+:\d+/;class Ie{static find(e){const t=["bootstrap.js","/paperboy/","/identity-service/confirm"].map((e=>`script[src*="${e}"][src*="triptease.io"]`));t.push('script[src*="triptease.net"]');const r=t.join(", ");return d.Arrays.from(e.querySelectorAll(r)).map((e=>new p(e.src)))}}class Ne{constructor(e){this.window=e}scrapeIdentifiers(){const e=Ie.find(this.window.document),t=Ce.create(this.window).get();return Ne.extract([...e,...t])}static extract(e){return d.Objects.removeEmpty(e.reduce(((e,t)=>{const r=e.integrationId?[e.integrationId]:[],n=e.clientKey?[e.clientKey]:[],i=e.apiKey?[e.apiKey]:[],s=e.identifiers?e.identifiers:[],a=h(t.query,!1),o=Ne.pathClientKey(t);o&&n.unshift(o),a.clientKey&&n.unshift(a.clientKey),r.unshift(a.integrationId);const c=je(Ne.queryApiKey(a));c.apiKey&&i.unshift(c.apiKey),c.clientKey&&n.unshift(c.clientKey),c.identifiers&&s.unshift(c.identifiers[0]);const[u]=r.filter(Boolean),[l]=n.filter(Boolean),[d]=i.filter(Boolean);return{integrationId:u,clientKey:l,apiKey:d,identifiers:s.filter(Boolean)}}),{}))}static queryApiKey(e){return e.apiKey||e.hotelkey||e.hotelKey||e["api-key"]||e.token}static pathClientKey(e){if("paperboy.triptease.net"===e.host){const[,t]=e.path.match(/\/+([^/.]+)(?:\.js)?$/)||[];return t}const[,t=""]=e.path.match(/\/paperboy\/+([^/.]+)(?:\.js)?$/)||[];if("paperboy"!=t&&"confirm"!=t)return t}}function Le(e){return Fe(e.tt_clientKey||e.document.ttClientKey||e.document.tt_clientKey)}const Me=["CLIENT_KEY","API_KEY"];function Fe(e){if(e&&!Me.includes(e))return e}class $e{constructor(e){this.window=e}scrapeIdentifiers(){const e=je(function(e,t){if(t){const r=d.get((()=>e.tt_apiKeys[t]))||d.get((()=>e.ttApiKeys[t]))||d.get((()=>e.document.apiKeys[t]))||d.get((()=>e.document.ttApiKeys[t]));if(r)return Fe(r)}return Fe(d.get((()=>e.ttData.apiKey))||e.ttApiKey||e.document.ttApiKey)}(this.window));return d.Objects.removeEmpty(Object.assign(Object.assign({},e),{clientKey:Le(this.window)}))}}class Re{constructor(e){this.pageData=e}scrapeIdentifiers(){return Te(this.pageData)}}class Ke{constructor(e,t){this.window=e,this.history=t}processIntegrationData(e){switch(e.type){case W.RoomsAndRates:return this.processRoomsAndRatesData(e);case W.Confirmation:return this.processConfirmationData(e)}return e}processRoomsAndRatesData(e){const t=d.Objects.removeEmpty(Object.assign(Object.assign({},e),{type:W.RoomsAndRates}));return t.rateDetails=_e(e),t.ratesModified=this.calculateRatesModified(t),t}processConfirmationData(e){const t=Object.assign(Object.assign({},e),{basePrice:Be(e.price,e.basePrice),reservationStatus:Ue(e)});t.reservations=function(e){if(!e.reservations){const{reference:t,price:r,currency:n,basePrice:i,reservationStatus:s}=e;return[d.Objects.removeEmpty({reference:t,price:r,currency:n,basePrice:i,reservationStatus:s})]}return e.reservations.map((e=>d.Objects.removeEmpty(Object.assign(Object.assign({},e),{basePrice:Be(e.price,e.basePrice)}))))}(t),t.basePrice=t.basePrice||function(e){if(e.some((e=>!e.basePrice)))return;return e.reduce(((e,t)=>{var r;return null!==(r=e+t.basePrice)&&void 0!==r?r:0}),0)}(t.reservations);const{checkin:r,checkout:n}=this.calculateCheckinAndCheckout(t);return t.checkin=r,t.checkout=n,d.Objects.removeEmpty(t)}calculateRatesModified(e){const{ratesModified:t,promoCodes:r}=e;return t||(this.hasSearchChangedWithoutRatesChanging(e)?"untrusted":this.hasRatesChangedWithoutSearchChanging(e)?"roomOrRateFiltered":r&&r.length>0?"discountCode":"none")}hasSearchChangedWithoutRatesChanging(e){const t=this.history.last();return!!se(t)&&(d.same(qe(e),qe(t))?void 0:d.sameIgnoringCase(e.rateDetails,t.rateDetails))}hasRatesChangedWithoutSearchChanging(e){const t=this.history.last();if(!se(t))return!1;if(!d.same(qe(e),qe(t)))return!1;const{rateDetails:r,ratesModified:n}=t;if("roomOrRateFiltered"===n)return!0;if("untrusted"===n)return!1;const{rateDetails:i}=e;return!(0===_e(t).length&&i&&i.length>0)&&!we.isSuperset(r,i)}calculateCheckinAndCheckout(e){const{checkin:t,checkout:r}=e;if(!t||!r){const e=this.history.find((e=>e.type===W.RoomsAndRates));if(e)return{checkin:e.checkin,checkout:e.checkout}}return{checkin:t,checkout:r}}}function qe(e){const{apiKey:t,checkin:r,checkout:n,rooms:i,adults:s,children:a}=e;return{apiKey:t,checkin:r,checkout:n,rooms:i,adults:s,children:a}}function _e(e){const t=e.rateDetails;return t?t.filter((e=>e.price>0)):[]}function Ue(e){const{reservationStatus:t,reservations:r}=e;if(t)return t;if(!r)return"confirmed";const n=d.Arrays.unique(r.map((e=>e.reservationStatus)));return 1===n.length?n[0]:"modified"}function Be(e,t){return function(e,t){return!!t&&(!e||e>t)}(e,t)?t:void 0}class We{constructor(e){this.rules=e}clean(e){return"string"==typeof e?this.rules.reduce(((e,t)=>"function"==typeof t?t(e):e.replace(t.search,t.replace)),e):Array.isArray(e)?e.map(Je):e&&"object"==typeof e?Object.keys(e).reduce(((t,r)=>{const n=e[r];return t[r]=this.clean(n),t}),{}):e}}const He=e=>e.trim(),ze=function(e){const t="(?:"+Object.keys(e).join("|")+")",r=RegExp(t),n=RegExp(t,"g");return function(t){return r.test(t)?t.replace(n,(t=>e[t])):t}}({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`","&nbsp;":" "}),Ve={search:/\s+/g,replace:" "},Ge=new We([{search:/{{.*}}/g,replace:""},ze,{search:/[,.\/#!$%^*;:{}\[\]()=_`~®©™'\u201C\u201D\u2018\u2019]+/g,replace:""},Ve,{search:/\s*(?:Image|Logo)\s*/gi,replace:""},{search:/\s*(?:Uniquement\s+Adultes|Adults?\s*(?:Only)\s*)/gi,replace:""},{search:/\s*[(\[]?Official\s*(?:Hotel)?\s*(?:((?:Web)?Site)|Homepage|booking\s*engine)\s*(?:for|of)?[)\]]?\s*/gi,replace:""},{search:/\sand\s/gi,replace:" & "},{search:/\s&$/,replace:""},d.titleCase,He]),Ye=new We([ze,Ve,He]);function Je(e){return Ge.clean(e)}function Xe(e,t,r,n="Untrusted"){return{source:e+"["+t+"]",identifier:Je(r),type:n}}class Ze{constructor(e,t){this.orderedStructuredDataTypes=e,this.type=t}from(e){return d.Arrays.flatten(this.filterStructuredData(e).map((e=>{const t=(Array.isArray(e.name)?e.name:[e.name]).flatMap((t=>({source:`structuredData[@type='${e["@type"]}'].name`,identifier:Je(this.addBrand(e.brand,t)),type:this.type}))),r=e.identifier;return r&&t.push({type:this.type,identifier:r,source:`structuredData[@type='${e["@type"]}'].identifier`}),t})))}addBrand(e,t){return e?t.indexOf(e)>=0?t:`${e} ${t}`:t}filterStructuredData(e){return e?e.filter((e=>this.orderedStructuredDataTypes.indexOf(e["@type"])>=0)).filter((e=>Boolean(e.name))).sort(((e,t)=>this.orderedStructuredDataTypes.indexOf(e["@type"])-this.orderedStructuredDataTypes.indexOf(t["@type"]))):[]}}const Qe=["Hotel","LodgingBusiness","BedAndBreakfast"],et=["WebSite","LocalBusiness","Organization"],tt=[...Qe,...et,"HotelRoom","LodgingReservation","Offer"];class rt{constructor(e=["dataLayer.context.hotelName","dataLayer.Cart.HName","dataLayer.propertyName","dataLayer.ihReservations.ihHotelName","dataLayer.ihHotelName","dataLayer.HName","dataLayer.transactionHotelName","dataLayer.ratequeryHotelName","dataLayer.hpr","dataLayer.strippedPropertyName","dataLayer.property_name","globalTokens.HName","dataLayer.flipto.sessionData.propertyName","dataLayer.HotelName","wlp.hotelInfo.name","Imperatore","rmsClientId","busyRooms"]){this.sources=e,this.identifierType="Trusted",this.logger=_("identifiers.trusted"),this.structuredDataSources=new Ze(Qe,this.identifierType)}fromProbe(e){return[...this.fromTrustedSources(e),...this.fromStructuredData(e.structuredData)].filter((e=>{switch(typeof e.identifier){case"string":case"number":return e.identifier;case"object":Array.isArray(e.identifier)?this.logger.log("Array found from",e.source):this.logger.log("Object found from",e.source)}}))}fromStructuredData(e){return this.structuredDataSources.from(e)}fromTrustedSources(e){return d.Arrays.flatten(this.sources.map((t=>d.Arrays.clean(d.Arrays.unique(d.getAll(e,...t.split(".")))).map(((e,r)=>Xe(t,r,e,this.identifierType))))))}}class nt{constructor(e){this.labels=e,this.identifierType="Untrusted",this.sources=["dataLayer.SynxisHotelName","location.context.channelId","location.context.hotel","location.context.hotelid","hotelCodeFromCookie","loews","explicitHotelIdentifier"],this.structuredDataSources=new Ze(et,this.identifierType)}fromProbe(e){const t=this.fromStructuredData(e.structuredData),r=this.fromUntrustedSources(e);return[...t,...this.labels,...r].filter((e=>"string"==typeof e.identifier||"number"==typeof e.identifier))}fromStructuredData(e){return this.structuredDataSources.from(e)}fromUntrustedSources(e){return d.Arrays.flatten(this.sources.map((t=>d.Arrays.clean(d.Arrays.unique(d.getAll(e,...t.split(".")))).map(((e,r)=>Xe(t,r,e,this.identifierType))))))}}const it=_("events");class st{constructor(e,t){this.timers=e,this.handle=t,this.finders=new Set,this.keepers=new WeakSet,this.handleEvent=e=>n(this,void 0,void 0,(function*(){try{if(it.debug("Checking for new created items"),0===this.finders.size)return;const t=Array.from(this.finders).flatMap((e=>e()));t.reduce(((e,t)=>this.keepers.has(t)?e:(this.keepers.add(t),!0)),!1)&&(it.log("Newly created element detected - firing event"),yield this.handle(e))}catch(e){it.error("CreatedEvents.handleEvent threw while polling",e)}}))}start(){return n(this,void 0,void 0,(function*(){it.log("Start polling for created items"),this.id=this.timers.setInterval(this.handleEvent,1e3)}))}stop(){return n(this,void 0,void 0,(function*(){it.log("Stop polling for created items"),this.id&&(this.timers.clearInterval(this.id),this.id=void 0)}))}watch(e){e().forEach((e=>this.keepers.add(e))),this.finders.add(e)}}function at(e){return new Promise((t=>{this.setTimeout((()=>{t()}),e)}))}class ot{constructor(e=new de){this.clock=e,this.delay=at.bind(this),this.delay=at}task(e){return n(this,void 0,void 0,(function*(){return yield this.delay(0),e()}))}setTimeout(e,t){return setTimeout(e,t)}clearTimeout(e){clearTimeout(e)}setInterval(e,t){return setInterval(e,t)}clearInterval(e){clearInterval(e)}requestIdleCallback(e,t){const r=t?t.timeout:1;let n=this.clock.now().getTime()+r;const i=this;return this.setTimeout((()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(i.clock.now().getTime()-n))})}),r)}cancelIdleCallback(e){this.clearTimeout(e)}}new ot;const ct=_("events");class ut{constructor(e,t){this.window=e,this.delegate=t,this.first=!0,this.fire=e=>n(this,void 0,void 0,(function*(){!this.window.document.hidden||this.first?(yield this.delegate.fire(),this.first=!1):ct.log("Document hidden - skipping",e)}))}listen(e){return n(this,void 0,void 0,(function*(){yield this.delegate.listen(e)}))}removeListener(e){this.delegate.removeListener(e)}}const lt=_("events");class dt{constructor(e,t){this.delegate=e,this.running=t,this.fire=e=>n(this,void 0,void 0,(function*(){this.running.value?lt.log("Already running - skipping",e):(this.running.value=!0,yield this.delegate.fire(),this.running.value=!1)}))}listen(e){return n(this,void 0,void 0,(function*(){if(yield this.delegate.listen(e),this.running.value){lt.log("Already running - firing immediately");try{yield e()}catch(e){lt.log(e)}}}))}removeListener(e){this.delegate.removeListener(e)}}const ht=_("events");class pt{constructor(){this.handlers=[],this.fire=e=>n(this,void 0,void 0,(function*(){ht.log(`Firing handlers(${this.handlers.length})`,e),yield Promise.all(this.handlers.map((e=>n(this,void 0,void 0,(function*(){try{yield e()}catch(e){ht.log("Error while firing handler",e)}})))))}))}listen(e){return n(this,void 0,void 0,(function*(){this.handlers.push(e)}))}removeListener(e){this.handlers=this.handlers.filter((t=>t!==e))}}const ft=_("events");class yt{constructor(e,t){this.timers=e,this.delegate=t,this.timeoutMs=1e3,this.timerId=0,this.fire=e=>n(this,void 0,void 0,(function*(){ft.log(`Event observed, waiting for ${this.timeoutMs} ms quiet`,e),this.timers.clearInterval(this.timerId),this.timerId=this.timers.setTimeout((()=>n(this,void 0,void 0,(function*(){ft.log("Event quiet period ended, firing event",e),yield this.delegate(e)}))),this.timeoutMs)}))}}const mt=_("events");class gt{constructor(e,t,r=.2,i=new ot){this.handle=e,this.running=t,this.idleThreshold=r,this.timers=i,this.lastState=!1,this.busy=!1,this.average=new vt,this.idleHandler=e=>{const t=e.timeRemaining();this.running.value?this.busy=!1:0===t?this.busy=!0:(this.average=this.average.calculate(t),this.busy=this.average.percentage<-this.idleThreshold),this.busy?this.idleId=void 0:this.idleId=this.timers.requestIdleCallback(this.idleHandler,0===t?void 0:{timeout:t})},this.intervalHandler=()=>n(this,void 0,void 0,(function*(){this.stateHasChanged()&&this.isIdle()&&(mt.log("Browser idle"),yield this.handle("Idle")),this.average=new vt,this.lastState=this.busy,this.idleId||(this.idleId=this.timers.requestIdleCallback(this.idleHandler))}))}start(){return n(this,void 0,void 0,(function*(){this.intervalId=this.timers.setInterval(this.intervalHandler,1e3),this.idleId=this.timers.requestIdleCallback(this.idleHandler)}))}stop(){return n(this,void 0,void 0,(function*(){this.intervalId&&this.timers.clearInterval(this.intervalId),this.idleId&&this.timers.cancelIdleCallback(this.idleId)}))}isIdle(){return!this.busy}stateHasChanged(){return this.lastState!==this.busy}}class vt{constructor(e=0,t=0,r=0,n=0){this.value=e,this.count=t,this.difference=r,this.percentage=n}calculate(e){const t=this.count+1,r=e-this.value,n=r/this.value,i=this.value+r/t;return new vt(i,t,r,n)}}class wt{constructor(e,t){this.window=e,this.handle=t}start(){return n(this,void 0,void 0,(function*(){this.window.addEventListener("visibilitychange",this.handle),this.window.addEventListener("popstate",this.handle),this.window.addEventListener("hashchange",this.handle),this.window.addEventListener("pageshow",this.handle),this.window.addEventListener("pagehide",this.handle),"complete"!==this.window.document.readyState?this.window.document.addEventListener("DOMContentLoaded",this.handle):yield this.handle("Document already loaded")}))}stop(){return n(this,void 0,void 0,(function*(){this.window.removeEventListener("visibilitychange",this.handle),this.window.removeEventListener("popstate",this.handle),this.window.removeEventListener("hashchange",this.handle),this.window.removeEventListener("pageshow",this.handle),this.window.removeEventListener("pagehide",this.handle),this.window.document.removeEventListener("DOMContentLoaded",this.handle)}))}}class bt{constructor(){this.value=!1}}class kt{constructor(e,t=new ot){this.window=e;const r=new bt;this.sink=new ut(e,new dt(new pt,r)),this.fire=new yt(t,this.sink.fire).fire,this.mutation=new At(this.fire),this.created=new st(t,this.fire),this.sources=[new gt(this.fire,r),this.mutation,this.created,new wt(e,this.fire)]}watch(e){this.created.watch(e)}listen(e){return n(this,void 0,void 0,(function*(){yield this.sink.listen(e)}))}start(){return n(this,void 0,void 0,(function*(){yield Promise.all(this.sources.map((e=>e.start())))}))}stop(){return n(this,void 0,void 0,(function*(){this.sources.forEach((e=>e.stop()))}))}removeListener(e){this.sink.removeListener(e)}}function Ot(e){const t=P(e).triptease;return t.events=t.events||new kt(e)}const St={characterData:!0,attributes:!0,childList:!0};class At{constructor(e){this.handle=e,this.observer=new MutationObserver(this.handle)}start(){return n(this,void 0,void 0,(function*(){}))}stop(){return n(this,void 0,void 0,(function*(){this.observer.disconnect()}))}static observe(e,t=St){if(!("MutationObserver"in d.globalThis))return e;const r=Ot(d.globalThis).mutation;return e instanceof HTMLInputElement||e instanceof HTMLSelectElement?e.addEventListener("change",r.handle):r.observer.observe(e,t),e}}function Dt(e){d.get((()=>Ot(d.globalThis).watch(function(e,t){return()=>Array.from(e.document.querySelectorAll(t))}(d.globalThis,e))))}class Pt{constructor(e){this.parent=e}querySelector(e,t){Dt(e);const r=this.parent.querySelector(e);return r?At.observe(r,t):void 0}querySelectorAll(e,t){return Dt(e),d.Arrays.from(this.parent.querySelectorAll(e)).map((e=>At.observe(e,t))).filter(Boolean)}}class xt{constructor(e,t,r){this.scope=e,this.property=t,this.seed=r}parentScope(e){const[,...t]=d.Elements.path(e);return d.Arrays.find(t,(e=>e.hasAttribute(this.scope)))}getValue(e){return e.hasAttribute(this.scope)?this.processScope(e):e.getAttribute("content")||e.getAttribute("src")||e.getAttribute("href")||e.getAttribute("data")||e.getAttribute("value")||e.getAttribute("datetime")||e.textContent}processScope(e){return d.Arrays.from(e.querySelectorAll(`*[${this.property}]`)).filter((t=>this.parentScope(t)===e)).reduce(((e,t)=>{const r=t.getAttribute(this.property);return r?d.accumulateMultipleValues(e,r,Ye.clean(this.getValue(t))):e}),this.seed(e))}processDocument(e){return new Pt(e).querySelectorAll(`*[${this.scope}]`).map(this.processScope.bind(this))}}const jt=new xt("itemscope","itemprop",(e=>{const t=(e.getAttribute("itemtype")||"Unknown").split("/");return Et("microdata",{"@type":t.pop(),"@context":t.join("/")})})),Tt=new xt("typeof","property",(e=>Et("rdfa",{"@type":e.getAttribute("typeof"),"@context":e.getAttribute("vocab")}))),Ct={processDocument:e=>d.Arrays.flatten(new Pt(e).querySelectorAll('script[type="application/ld+json"]').map((e=>{const t=(e.textContent||"").replace(/[\r\n]/g," ");try{const e=JSON.parse(t),r=e["@graph"]||e;return Array.isArray(r)?r.map((e=>Et("json-ld",e))):Et("json-ld",e)}catch(e){return{"@type":"Error",error:e.toString(),json:t}}})))};function Et(e,t){return Object.assign(Object.assign({},t),{"@format":e})}const It={processDocument:e=>[...Ct.processDocument(e),...jt.processDocument(e),...Tt.processDocument(e)]};function*Nt(e,t){const r=Array.isArray(e)?e:[e];for(const e of r)if(e["@type"]===t)yield e;else for(const r of Object.values(e))Y(r)&&(yield*Nt(r,t))}function Lt(e,t){const[r]=Nt(e,t);return r}class Mt{constructor(e,t={},r=e.document,n=new ot,i=50){this.window=e,this.context=t,this.document=r,this.timers=n,this.maxIdentifiers=i}probe(){const e=this.identifierSources();return Object.assign(Object.assign({},this.baseData()),{identifierSources:e})}baseData(){return{context:this.context,language:this.language,location:this.location,referrer:this.document.referrer,structuredData:this.structuredData}}windowData(){const e=this.baseData(),t=d.get((()=>this.window.document.querySelector("#clienId").value),void 0);return d.Objects.removeEmpty(Object.assign(Object.assign({},e),{dataLayer:this.dataLayer,globalTokens:this.window._GlobalTokens||{},wlp:this.window.wlp||{},imperatore:this.window.Imperatore,busyRooms:this.window.$IBE_hotelName,rmsClientId:t,hotelCodeFromCookie:this.cookie.HotelCode,loews:this.window._reztrack&&this.window._reztrack.send&&this.window._reztrack.send.name,explicitHotelIdentifier:this.window.explicitHotelIdentifier}))}identifierSources(){const e=this.windowData(),t=(new rt).fromProbe(e);if(t.length>0)return t.slice(0,this.maxIdentifiers);return new nt(this.labels).fromProbe(e).slice(0,this.maxIdentifiers)}get dataLayer(){return d.get((()=>[...this.window.dataLayer].filter((e=>d.get((()=>0!==e.event.indexOf("gtm.")),!0))).reverse()),[])}get cookie(){return d.get((()=>this.parseCookies()),{})}parseCookies(){return this.document.cookie.split(";").reduce(((e,t)=>{const[r,n]=t.trim().split("=").map(decodeURIComponent);return e[r]=n,e}),{})}get language(){return{browser:this.window.navigator.language,html:this.document.documentElement.getAttribute("lang")||this.document.documentElement.getAttribute("xml:lang")||""}}get location(){const e={href:this.window.location.href,host:this.window.location.host},t=h(this.window.location.search,!1);return Object.assign(Object.assign({},e),{context:t})}get labels(){return[...this.titles,...this.metaLabels].filter((e=>e.identifier&&e.identifier.length>2&&e.identifier.length<93))}get titles(){return this.document.title.split(/[|\-:]/).reverse().map(((e,t)=>Xe("title",t,e)))}get meta(){return d.Arrays.from(this.document.getElementsByTagName("meta")).reduce(((e,t)=>{const r=t.getAttribute("name")||t.getAttribute("property")||t.getAttribute("http-equiv"),n=t.getAttribute("content");return r?e[r]=n:(e.unknown=e.unknown||[],e.unknown.push(d.Arrays.from(t.attributes).map((e=>[e.name,e.value])))),e}),{})}get metaLabels(){const e=["site-id","og:title","og:site_name","twitter:title"],t=this.meta;return Object.keys(t).filter((t=>-1!=e.indexOf(t))).map(((e,r)=>Xe("meta."+e,r,t[e])))}get structuredData(){return It.processDocument(this.document).filter((e=>-1!==tt.indexOf(e["@type"])))}}function Ft(e){if(e.hasOwnProperty("parentElement"))return e.parentElement;const t=e.parentNode;return t instanceof Element?t:t?Ft(t):null}const $t=/^\s*$/,Rt=["script","style","noscript","a"].map((e=>e.toUpperCase())),Kt=e=>{return!((e=>e instanceof Text&&$t.test(e.data))(e)||(t=Ft(e),t&&-1!==Rt.indexOf(t.tagName)));var t};function qt(e){return e instanceof Element?e:Ft(e)}function _t(e,t){const r=t.documentElement.scrollWidth,n=t.documentElement.scrollHeight,i=t.documentElement.scrollLeft,s=t.documentElement.scrollTop;if(0==r||0==n)return;const a=function(e){const t=qt(e);if(t)return t.getBoundingClientRect()}(e);return a?{x:(a.left+i)/r,y:(a.top+s)/n,width:a.width/r,height:a.height/n}:void 0}function Ut(e){return e instanceof Text?e.data.trim():e instanceof Element&&(e.getAttribute("aria-label")||e.getAttribute("title")||e.getAttribute("alt"))||void 0}function Bt(e,t=.8){return e.y<t&&e.width>0&&e.height>0}class Wt{constructor(e,t=_("hotel-identifiers-scraper")){this.window=e,this.logger=t}scrapeIdentifiers(){return{identifiers:this.identifierSources().map((e=>({identifier:e.identifier,type:e.type})))}}identifierSources(){const e=new Mt(this.window).identifierSources();if(this.logger.log("Common identifiers",e),d.Arrays.find(e,(e=>"Trusted"===e.type)))return e;{const t=function(e,t=Bt){const r=e.document,n=[],i=r.createNodeIterator(r.documentElement,NodeFilter.SHOW_TEXT,null);for(;;){const e=i.nextNode();if(!e)break;Kt(e)&&n.push(e)}const s=r.querySelectorAll("[aria-label], img[title], img[alt]");for(let e=0;e<s.length;e++)n.push(s[e]);n.sort(((e,t)=>{const r=qt(e).compareDocumentPosition(qt(t));return r&Node.DOCUMENT_POSITION_PRECEDING?1:r&Node.DOCUMENT_POSITION_FOLLOWING?-1:0}));const a=[];for(let e=0;e<n.length;e++){const i=n[e],s=_t(i,r);if(s&&!t(s))continue;const o=Ut(i);"string"==typeof o&&o.split(/[\r\n]/).forEach((e=>{if(e.length>2&&e.length<93){const t=qt(i);a.push({source:t?t.tagName.toLowerCase():"",type:"Untrusted",identifier:Je(e)})}}))}return a}(this.window);return this.logger.log("Additional identifiers",t),[...e,...t]}}}function Ht(e){return!!e&&(Q(e)?!!e.apiKey||!!e.identifiers&&e.identifiers.length>0||e.type===W.Group:Array.isArray(e)?e.reduce(((e,t)=>e||Ht(t)),!1):e.constructor===Object&&Ht(d.Objects.values(e)))}var zt={};Object.defineProperty(zt,"__esModule",{value:!0});var Vt=(In=void 0,Nn=zt.ascending=In,Ln=zt.descending=Nn,Mn=zt.comparators=Ln,Fn=zt.key=Mn,Rn=zt.value=Fn,Kn=zt.isIterable=Rn,qn=zt.isAsyncIterable=Kn,_n=zt.isPromiseLike=qn,Un=zt.toIterable=_n,Wn=zt.iterable=Un,Hn=zt.isArrayLike=Wn,zn=zt.array=Hn,Vn=zt.toAsyncIterable=zn,zt.by=Vn);zt.single=Vt;var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});var Yt=(Sn=void 0,An=Gt.iterate=Sn,Dn=Gt.repeat=An,xn=Gt.range=Dn,Tn=Gt.sequence=xn,Gt.Sequence=Tn);Gt.AsyncSequence=Yt;var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});var Xt=(Zt=void 0,Qt=Jt.increment=Zt,er=Jt.add=Qt,Jt.subtract=er);Jt.sum=Xt;var Zt=function(e){return e+1};Jt.increment=Zt;var Qt=function(e,t){return void 0===t?t=>e+t:e+t};Jt.add=Qt;var er=function(e,t){return void 0===t?t=>t-e:e-t};Jt.subtract=er,Xt=(e,t)=>e+t,Jt.sum=Xt;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});var rr=(fr=void 0,mr=tr.IdentityTransducer=fr,gr=tr.identity=mr,wr=tr.transducer=gr,kr=tr.FirstTransducer=wr,Sr=tr.first=kr,Dr=tr.LastTransducer=Sr,xr=tr.last=Dr,jr=tr.MapTransducer=xr,Cr=tr.map=jr,Er=tr.ZipTransducer=Cr,Ir=tr.zip=Er,Lr=tr.zipWithIndex=Ir,Mr=tr.FlatMapTransducer=Lr,$r=tr.flatMap=Mr,Kr=tr.FilterTransducer=$r,qr=tr.filter=Kr,_r=tr.reject=qr,Br=tr.find=_r,Hr=tr.CompositeTransducer=Br,zr=tr.compose=Hr,Gr=tr.decompose=zr,Jr=tr.ScanTransducer=Gr,Xr=tr.scan=Jr,Qr=tr.reduce=Xr,en=tr.TakeTransducer=Qr,rn=tr.take=en,nn=tr.DropTransducer=rn,an=tr.drop=nn,on=tr.DropWhileTransducer=an,un=tr.dropWhile=on,ln=tr.TakeWhileTransducer=un,hn=tr.takeWhile=ln,pn=tr.SortTransducer=hn,yn=tr.sort=pn,mn=tr.DedupTransducer=yn,vn=tr.dedupe=mn,wn=tr.UniqueTransducer=vn,bn=tr.unique=wn,tr.windowed=bn);tr.WindowedTransducer=rr;var nr={};Object.defineProperty(nr,"__esModule",{value:!0});var ir=void 0;nr.AVLTree=ir;class sr{constructor(e){this.comparator=e}static empty(e=zt.ascending){return new ar(e)}static create(e,t,r=zt.ascending){const n=sr.empty(r);return new or(r,e,t,n,n)}static of(e,t=zt.ascending){return sr.preSorted(e.sort(zt.by(0)),t,sr.empty(t))}static preSorted(e,t,r){const n=e.length;switch(n){case 0:return r;case 1:{const[[n,i]]=e;return new or(t,n,i,r,r)}default:{const i=Math.floor(n/2),s=sr.preSorted(e.slice(0,i),t,r),a=sr.preSorted(e.slice(i+1),t,r),[o,c]=e[i];return new or(t,o,c,s,a)}}}}ir=sr,nr.AVLTree=ir;class ar extends sr{constructor(e){super(e),this.isEmpty=!0,this.height=0,this.balance=0}insert(e,t){return new or(this.comparator,e,t,this,this)}contains(e){return!1}lookup(e){}delete(e){return{tree:this}}first(){}last(){}removeFirst(){return{tree:this}}removeLast(){return{tree:this}}toString(){return""}*keys(){}*values(){}*entries(){return[]}}class or extends sr{constructor(e,t,r,n,i){super(e),this.key=t,this.value=r,this.left=n,this.right=i,this.isEmpty=!1}insert(e,t){const r=this.comparator(e,this.key);return 0===r?new or(this.comparator,e,t,this.left,this.right):r<0?this.replaceLeft(this.left.insert(e,t)):this.replaceRight(this.right.insert(e,t))}contains(e){const t=this.comparator(e,this.key);return 0===t||(t<0?this.left.contains(e):this.right.contains(e))}lookup(e){const t=this.comparator(e,this.key);return 0===t?this.value:t<0?this.left.lookup(e):this.right.lookup(e)}delete(e){const t=this.comparator(e,this.key);if(0===t){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};const{tree:e,key:t,value:r}=this.left.removeLast();return{tree:cr(new or(this.comparator,t,r,e,this.right)),key:this.key,value:this.value}}if(t<0){const{tree:t,key:r,value:n}=this.left.delete(e);return{tree:this.replaceLeft(t),key:r,value:n}}const{tree:r,key:n,value:i}=this.right.delete(e);return{tree:this.replaceRight(r),key:n,value:i}}first(){return this.left.isEmpty?this.value:this.left.first()}last(){return this.right.isEmpty?this.value:this.right.last()}removeFirst(){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};const{tree:e,key:t,value:r}=this.left.removeFirst();return{tree:this.replaceLeft(e),key:t,value:r}}removeLast(){if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};const{tree:e,key:t,value:r}=this.right.removeLast();return{tree:this.replaceRight(e),key:t,value:r}}replaceLeft(e){return cr(new or(this.comparator,this.key,this.value,e,this.right))}replaceRight(e){return cr(new or(this.comparator,this.key,this.value,this.left,e))}toString(){return`(${this.left} ${this.key}=${this.value} ${this.right})`}get balance(){return this.left.height-this.right.height}get height(){return Math.max(this.left.height,this.right.height)+1}*keys(){yield*this.left.keys(),yield this.key,yield*this.right.keys()}*values(){yield*this.left.values(),yield this.value,yield*this.right.values()}*entries(){yield*this.left.entries(),yield[this.key,this.value],yield*this.right.entries()}}function cr(e){const t=e.balance;return-2==t?function(e){const t=e.right.balance;return 1==t?function(e){const t=hr(e.right);return lr(e.replaceRight(t))}(e):-1==t?lr(e):e}(e):2==t?function(e){const t=e.left.balance;return-1==t?function(e){const t=dr(e.left);return ur(e.replaceLeft(t))}(e):1==t?ur(e):e}(e):e}function ur(e){return hr(e)}function lr(e){return dr(e)}function dr(e){const t=e.right,r=t.left,n=e.replaceRight(r);return t.replaceLeft(n)}function hr(e){const t=e.left,r=t.right,n=e.replaceLeft(r);return t.replaceRight(n)}t([v.lazy],or.prototype,"balance",null),t([v.lazy],or.prototype,"height",null);class pr{async_(e){return e}sync(e){return e}}var fr=pr;function yr(){return new pr}tr.IdentityTransducer=fr;var mr=yr;tr.identity=mr;var gr=yr;tr.transducer=gr;class vr{async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;return yield o(yield yield o(e))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e)return yield t}}var wr=vr;function br(){return new vr}tr.FirstTransducer=wr;var kr=br;tr.first=kr;class Or{async_(e){return c(this,arguments,(function*(){var t,r;let n;try{for(var i,s=l(e);!(i=yield o(s.next())).done;)n=i.value}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=s.return)&&(yield o(r.call(s)))}finally{if(t)throw t.error}}void 0!==n&&(yield yield o(n))}))}*sync(e){let t;for(t of e);void 0!==t&&(yield t)}}var Sr=Or;function Ar(){return new Or}tr.LastTransducer=Sr;var Dr=Ar;tr.last=Dr;class Pr{constructor(e){this.mapper=e}async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;yield yield o(this.mapper(e))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e)yield this.mapper(t)}}var xr=Pr;tr.MapTransducer=xr;var jr=function(e){return new Pr(e)};tr.map=jr;class Tr{constructor(e){this.other=e}async_(e){return c(this,arguments,(function*(){if(!zt.isAsyncIterable(this.other))throw new Error("Unsupported operation exception");const t=e[Symbol.asyncIterator](),r=this.other[Symbol.asyncIterator]();for(;;){const[e,n]=yield o(Promise.all([t.next(),r.next()]));if(e.done||n.done)return yield o(void 0);yield yield o([e.value,n.value])}}))}*sync(e){if(!zt.isIterable(this.other))throw new Error("Unsupported operation exception");const t=e[Symbol.iterator](),r=this.other[Symbol.iterator]();for(;;){const e=t.next(),n=r.next();if(e.done||n.done)return;yield[e.value,n.value]}}}var Cr=Tr;tr.ZipTransducer=Cr;var Er=function(e){return new Tr(e)};tr.zip=Er;var Ir=function(){return new Tr(Gt.range(0))};tr.zipWithIndex=Ir;class Nr{constructor(e){this.mapper=e}async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;yield o(yield*u(l(this.mapper(e))))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e)yield*this.mapper(t)}}var Lr=Nr;tr.FlatMapTransducer=Lr;var Mr=function(e){return new Nr(e)};tr.flatMap=Mr;class Fr{constructor(e){this.predicate=e}async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;this.predicate(e)&&(yield yield o(e))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e)this.predicate(t)&&(yield t)}}var $r=Fr;function Rr(e){return new Fr(e)}tr.FilterTransducer=$r;var Kr=Rr;tr.filter=Kr;var qr=function(e){return new Fr((t=>!e(t)))};tr.reject=qr;var _r=function(e){return Wr(Rr(e),br())};tr.find=_r;class Ur{constructor(e,t){this.a=e,this.b=t}async_(e){return this.b.async_(this.a.async_(e))}sync(e){return this.b.sync(this.a.sync(e))}}var Br=Ur;function Wr(e,t){return new Ur(e,t)}tr.CompositeTransducer=Br;var Hr=Wr;tr.compose=Hr;var zr=function*e(t){t instanceof Ur?(yield*e(t.a),yield*e(t.b)):yield t};tr.decompose=zr;class Vr{constructor(e,t){this.reducer=e,this.seed=t}async_(e){return c(this,arguments,(function*(){var t,r;let n=this.seed;yield yield o(n);try{for(var i,s=l(e);!(i=yield o(s.next())).done;){const e=i.value;yield yield o(n=this.reducer(n,e))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=s.return)&&(yield o(r.call(s)))}finally{if(t)throw t.error}}}))}*sync(e){let t=this.seed;yield t;for(const r of e)yield t=this.reducer(t,r)}}var Gr=Vr;function Yr(e,t){return new Vr(e,t)}tr.ScanTransducer=Gr;var Jr=Yr;tr.scan=Jr;var Xr=function(e,t){return Wr(Yr(e,t),Ar())};tr.reduce=Xr;class Zr{constructor(e){this.count=e}async_(e){return c(this,arguments,(function*(){var t,r;if(this.count<1)return yield o(void 0);try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;if(yield yield o(e),--this.count<1)return yield o(void 0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){if(!(this.count<1))for(const t of e)if(yield t,--this.count<1)return}}var Qr=Zr;tr.TakeTransducer=Qr;var en=function(e){return new Zr(e)};tr.take=en;class tn{constructor(e){this.count=e}async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;--this.count<0&&(yield yield o(e))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e)--this.count<0&&(yield t)}}var rn=tn;tr.DropTransducer=rn;var nn=function(e){return new tn(e)};tr.drop=nn;class sn{constructor(e){this.predicate=e}async_(e){return c(this,arguments,(function*(){var t,r;let n=!0;try{for(var i,s=l(e);!(i=yield o(s.next())).done;){const e=i.value;n&&(n=this.predicate(e)),n||(yield yield o(e))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=s.return)&&(yield o(r.call(s)))}finally{if(t)throw t.error}}}))}*sync(e){let t=!0;for(const r of e)t&&(t=this.predicate(r)),t||(yield r)}}var an=sn;tr.DropWhileTransducer=an;var on=function(e){return new sn(e)};tr.dropWhile=on;class cn{constructor(e){this.predicate=e}async_(e){return c(this,arguments,(function*(){var t,r;try{for(var n,i=l(e);!(n=yield o(i.next())).done;){const e=n.value;if(!this.predicate(e))return yield o(void 0);yield yield o(e)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&(yield o(r.call(i)))}finally{if(t)throw t.error}}}))}*sync(e){for(const t of e){if(!this.predicate(t))return;yield t}}}var un=cn;tr.TakeWhileTransducer=un;var ln=function(e){return new cn(e)};tr.takeWhile=ln;class dn{constructor(e){this.comparator=e}async_(e){return c(this,arguments,(function*(){const t=yield o(zt.array(e));t.sort(this.comparator),yield o(yield*u(l(t)))}))}*sync(e){const t=zt.array(e);t.sort(this.comparator),yield*t}}var hn=dn;tr.SortTransducer=hn;var pn=function(e=zt.ascending){return new dn(e)};tr.sort=pn;class fn{constructor(e){this.comparator=e}async_(e){return c(this,arguments,(function*(){var t,r;let n;try{for(var i,s=l(e);!(i=yield o(s.next())).done;){const e=i.value;(void 0===n||0!==this.comparator(e,n))&&(yield yield o(e)),n=e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=s.return)&&(yield o(r.call(s)))}finally{if(t)throw t.error}}}))}*sync(e){let t;for(const r of e)(void 0===t||0!==this.comparator(r,t))&&(yield r),t=r}}var yn=fn;tr.DedupTransducer=yn;var mn=function(e=zt.ascending){return new fn(e)};tr.dedupe=mn;class gn{constructor(e){this.comparator=e}async_(e){return c(this,arguments,(function*(){var t,r;let n=nr.AVLTree.empty(this.comparator);try{for(var i,s=l(e);!(i=yield o(s.next())).done;){const e=i.value;n.contains(e)||(n=n.insert(e,void 0),yield yield o(e))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=s.return)&&(yield o(r.call(s)))}finally{if(t)throw t.error}}}))}*sync(e){let t=nr.AVLTree.empty(this.comparator);for(const r of e)t.contains(r)||(t=t.insert(r,void 0),yield r)}}var vn=gn;tr.UniqueTransducer=vn;var wn=function(e=zt.ascending){return new gn(e)};tr.unique=wn;var bn=function(e,t=1,r=!1){return new kn(e,t,r)};tr.windowed=bn;class kn{constructor(e,t,r){this.size=e,this.step=t,this.remainder=r}async_(e){return c(this,arguments,(function*(){var t,r;let n=[],i=0;try{for(var s,a=l(e);!(s=yield o(a.next())).done;){const e=s.value;i>0?i--:(n.push(e),n.length===this.size&&(yield yield o([...n]),n=n.slice(this.step),this.step>this.size&&(i=this.step-this.size)))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&(yield o(r.call(a)))}finally{if(t)throw t.error}}this.remainder&&(yield yield o([...n]))}))}*sync(e){let t=[],r=0;for(const n of e)r>0?r--:(t.push(n),t.length===this.size&&(yield[...t],t=t.slice(this.step),this.step>this.size&&(r=this.step-this.size)));this.remainder&&(yield[...t])}}function*On(e,t){for(;;)yield t,t=e(t)}rr=kn,tr.WindowedTransducer=rr;var Sn=On;Gt.iterate=Sn;var An=function*(e){for(;;)yield e()};Gt.repeat=An;var Dn=function*(e,t,r=1){if(0===r)throw new Error("step can not be 0");if(void 0===t)yield*On(Jt.add(r),e);else{const n=Math.abs(r);t<e?yield*Pn(On(Jt.subtract(n),e),tr.takeWhile((e=>e>=t))):yield*Pn(On(Jt.add(n),e),tr.takeWhile((e=>e<=t)))}};function Pn(e,...t){return zt.isIterable(e)?new jn(e,t):zt.isArrayLike(e)?new jn(zt.iterable(e),t):new Cn(e,t)}Gt.range=Dn;var xn=Pn;Gt.sequence=xn;class jn{constructor(e,t){this.source=e,this.transducers=t}[Symbol.iterator](){return this.transducers.reduce(((e,t)=>t.sync(e)),this.source)[Symbol.iterator]()}}var Tn=jn;Gt.Sequence=Tn;class Cn{constructor(e,t){this.source=e,this.transducers=t}[Symbol.asyncIterator](){return this.transducers.reduce(((e,t)=>t.async_(e)),this.source)[Symbol.asyncIterator]()}}function En(e,t){return e<t?-1:e>t?1:0}Yt=Cn,Gt.AsyncSequence=Yt;var In=En;zt.ascending=In;var Nn=function(e,t){return e<t?1:e>t?-1:0};zt.descending=Nn;var Ln=function(...e){return(t,r)=>{for(const n of e){const e=n(t,r);if(0!=e)return e}return 0}};zt.comparators=Ln;var Mn=function(e){return Object.assign((t=>t[e]),{name:e})};zt.key=Mn;var Fn=function(e){return t=>t[e]};function $n(e){return"object"==typeof e&&Symbol.iterator in e}zt.value=Fn;var Rn=$n;zt.isIterable=Rn;var Kn=function(e){return"object"==typeof e&&Symbol.asyncIterator in e};zt.isAsyncIterable=Kn;var qn=function(e){return"object"==typeof e&&"then"in e};zt.isPromiseLike=qn;var _n=function(...e){return e};zt.toIterable=_n;var Un=function*(e){for(let t=0;t<e.length;t++)yield e[t]};function Bn(e){return"object"==typeof e&&"number"==typeof e.length}zt.iterable=Un;var Wn=Bn;zt.isArrayLike=Wn;var Hn=function(e,...t){return $n(e)||Bn(e)?function(e){const t=[];for(const r of e)t.push(r);return t}(Gt.sequence(e,...t)):function(e){var t,r,i,s;return n(this,void 0,void 0,(function*(){const n=[];try{for(t=l(e);!(r=yield t.next()).done;){const e=r.value;n.push(e)}}catch(e){i={error:e}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}return n}))}(Gt.sequence(e,...t))};zt.array=Hn;var zn=function(e){return c(this,arguments,(function*(){yield yield o(e)}))};zt.toAsyncIterable=zn;var Vn=function(e,t=En){return"function"==typeof e?function(e,t=En){return(r,n)=>t(e(r),e(n))}(e,t):function(e,t=En){return(r,n)=>t(r[e],n[e])}(e,t)};function Gn(e){return e?e.trim().split(/[-_]/).filter(Boolean).map(((e,t)=>0===t?e.toLowerCase():e)):[]}function Yn(e){const[t]=Gn(e);return t}function Jn(e){const t=Gn(e);if(0!==t.length)return t.join("-")}zt.by=Vn,Vt=function(e,...t){return $n(e)?function(e){for(const t of e)return t;throw new Error("Expected a single value")}(Gt.sequence(e,...t)):function(e){var t,r,i,s;return n(this,void 0,void 0,(function*(){try{for(t=l(e);!(r=yield t.next()).done;){return r.value}}catch(e){i={error:e}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}throw new Error("Expected a single value")}))}(Gt.sequence(e,...t))},zt.single=Vt;class Xn{localeOf(e){return[e.documentElement.lang,e.documentElement.getAttribute("xml:lang")].filter(Boolean)}}class Zn{localeOf(e){var t;const r=h(null===(t=e.defaultView)||void 0===t?void 0:t.location.search).lang;return"string"!=typeof r?[]:[r]}}class Qn{constructor(e){this.tld=e}static create(e){const[,t]=d.get((()=>e.defaultView.location.hostname.match(Qn.pattern)))||[];return new Qn(t)}enrich(e){const t=d.get((()=>Qn.mapping[this.tld]),this.tld);return t&&Qn.validate(`${e}-${t}`)||e}static validate(e){try{const[t]=Intl.DateTimeFormat.supportedLocalesOf(e);return t}catch(e){}}}function ei(e){if(!e)return!1;try{const[t]=Intl.DateTimeFormat.supportedLocalesOf(e);return!!t}catch(e){}return!1}Qn.pattern=/\.(\w{2})$/,Qn.mapping={uk:"GB",co:"US"};class ti{constructor(){this.detectors=[new Zn,new Xn]}static detectLocale(e){const[t]=ti.instance.localeOf(e);return t}localeOf(e){return zt.array(this.detectors,tr.flatMap((t=>t.localeOf(e))),tr.map(Jn),tr.filter(ei),tr.unique(zt.by(Yn)))}}ti.instance=new ti;var ri={};Object.defineProperty(ri,"__esModule",{value:!0});var ni=(Gi=void 0,Yi=ri.NamedRegexParser=Gi,Xi=ri.namedRegexParser=Yi,Zi=ri.PreProcessor=Xi,es=ri.preProcess=Zi,ts=ri.MappingParser=es,ns=ri.mappingParser=ts,ss=ri.DatumLookup=ns,os=ri.uniqueMatch=ss,cs=ri.prefer=os,ls=ri.infer=cs,hs=ri.OrParser=ls,ps=ri.or=hs,ys=ri.parsers=ps,ms=ri.AllParser=ys,vs=ri.all=ms,ws=ri.CachingParser=vs,bs=ri.boundaryDelimiters=ws,Os=ri.atBoundaryOnly=bs,Ss=ri.Numerals=Os,Ds=ri.numberFormatter=Ss,xs=ri.digits=Ds,Ts=ri.Spaces=xs,Es=ri.numberPattern=Ts,Ls=ri.mapIgnoreError=Es,Fs=ri.separatorsOf=Ls,Ks=ri.NumberParser=Fs,ri.numberParser=Ks);ri.numberOf=ni;var ii={};Object.defineProperty(ii,"__esModule",{value:!0});var si=(ci=void 0,ui=ii.NamedRegExp=ci,li=ii.isNamedMatch=ui,hi=ii.isNonMatch=li,fi=ii.replace=hi,mi=ii.prefix=fi,gi=ii.suffix=mi,wi=ii.different=gi,ki=ii.removeUnneededUnicodeCharacters=wi,ii.characters=ki);ii.splitByRegex=si;const ai=/\(\?<([^>]+)>/g;class oi{constructor(e,t){this.pattern=e,this.names=t}static create(e,t){const r=[],n=di(ai,e,(e=>(r.push(e[1]),"(")));return new oi(new RegExp(n,t),r)}match(e){const t=e.match(this.pattern);return t?this.namedMatch(t):[]}namedMatch(e){return e.slice(1).map(((e,t)=>({name:this.names[t],value:e})))}*exec(e){const t=new RegExp(this.pattern.source,"g");for(;;){const r=t.exec(e);if(!r)break;yield this.namedMatch(r)}}*iterate(e){let t=0;const r=new RegExp(this.pattern.source,"g");for(;;){const n=r.exec(e);if(!n)break;const i=e.substring(t,n.index);i&&(yield i),yield this.namedMatch(n),t=r.lastIndex}const n=e.substring(t);n&&(yield n)}toString(){return`Pattern: ${this.pattern} Names: ${JSON.stringify(this.names)}`}toJSON(){return{pattern:this.pattern.source,names:this.names}}}var ci=oi;ii.NamedRegExp=ci;var ui=function(e){return Array.isArray(e)};ii.isNamedMatch=ui;var li=function(e){return"string"==typeof e};function di(e,t,r,n=(e=>e)){const i=[];let s,a=0;for(;null!=(s=e.exec(t));)i.push(n(t.substring(a,s.index))),i.push(r(s)),a=e.lastIndex;return i.push(n(t.substring(a))),i.join("")}ii.isNonMatch=li;var hi=di;function pi(e,t){for(let r=0;r<e.length;r++){if(e[r]!=t[r])return r}return e.length}ii.replace=hi;var fi=pi;function yi(e,t){return pi([...e].reverse(),[...t].reverse())}ii.prefix=fi;var mi=yi;ii.suffix=mi;var gi=function(e){const t=e.map(bi),[r,n]=t.reduce((([e,r],n,i)=>{const s=i<t.length-1?t[i+1]:t[0],a=pi(n,s),o=yi(n,s);return[a<e?a:e,o<r?o:r]}),[Number.MAX_VALUE,Number.MAX_VALUE]);return t.map((e=>e.slice(r,n?-n:void 0).join("")))};function vi(e){const t=e.charCodeAt(0);return 8206!=t&&8207!=t}ii.different=gi;var wi=vi;function bi(e){return function(e){return"function"==typeof Symbol&&e[Symbol.iterator]?[...e]:Si(e)}(e).filter(vi)}ii.removeUnneededUnicodeCharacters=wi;var ki=bi;ii.characters=ki;const Oi=/(?=(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/;function Si(e){return e.split(Oi)}si=Si,ii.splitByRegex=si;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});var Di=(xi=void 0,Ti=Ai.TrieFactory=xi,Ei=Ai.Trie=Ti,Ii=Ai.pair=Ei,Li=Ai.DEFAULT_COMPARATOR=Ii,Ai.PrefixTree=Li);Ai.Row=Di;class Pi{constructor(e=zt.ascending){this.comparator=e}get avlTree(){return nr.AVLTree.empty(this.comparator)}get empty(){return new ji(this,void 0,this.avlTree)}create(e,t=this.avlTree){return new ji(this,e,t)}construct(e,t){if(0===e.length)return this.create(t);const[r,...n]=e;return this.create(void 0,this.avlTree.insert(r,this.construct(n,t)))}}t([v.lazy],Pi.prototype,"avlTree",null),t([v.lazy],Pi.prototype,"empty",null);var xi=Pi;Ai.TrieFactory=xi;class ji{constructor(e=new Pi,t,r=e.avlTree){this.factory=e,this.value=t,this.children=r}contains(e){return!!this.lookup(e)}get isEmpty(){return!this.value&&this.children.isEmpty}lookup(e){if(0==e.length)return this.value;const[t,...r]=e,n=this.children.lookup(t);return n&&n.lookup(r)}match(e){if(0==e.length)return zt.single(this.children.values(),tr.reduce(((t,r)=>t.concat(r.match(e))),this.value?[this.value]:[]));const[t,...r]=e,n=this.children.lookup(t);return n?n.match(r):[]}insert(e,t){if(0===e.length)return this.factory.create(t,this.children);const[r,...n]=e;let i=this.children.lookup(r);return i=i?i.insert(n,t):this.factory.construct(n,t),this.factory.create(this.value,this.children.insert(r,i))}delete(e){return this.insert(e,void 0)}entries(){function e(t,r){return Gt.sequence(t.children.entries(),tr.flatMap((t=>function*(t,[r,n]){t=[...t,r],n.value&&(yield Ci(t,n.value)),yield*e(n,t)}(r,t))))}return e(this,[])}keys(){return Gt.sequence(this.entries(),tr.map((([e])=>e)))}values(){return Gt.sequence(this.entries(),tr.map((([,e])=>e)))}get height(){return zt.single(this.children.values(),tr.reduce(((e,t)=>Math.max(e,t.height+1)),0))}toString(){return(this.value?`(${this.value})`:"")+this.children}}t([v.lazy],ji.prototype,"isEmpty",null),t([v.lazy],ji.prototype,"height",null);var Ti=ji;function Ci(e,t){return[e,t]}Ai.Trie=Ti;var Ei=Ci;Ai.pair=Ei;var Ii=new Intl.Collator(void 0,{usage:"sort",sensitivity:"base"}).compare;Ai.DEFAULT_COMPARATOR=Ii;class Ni{constructor(e=ii.characters,t=Ai.DEFAULT_COMPARATOR,r=new ji(new Pi(t))){this.converter=e,this.comparator=t,this.trie=r}contains(e){return!!this.lookup(e)}get isEmpty(){return this.trie.isEmpty}match(e){return this.trie.match(this.converter(e))}lookup(e){return this.trie.lookup(this.converter(e))}insert(e,t=e){return new Ni(this.converter,this.comparator,this.trie.insert(this.converter(e),t))}delete(e){return new Ni(this.converter,this.comparator,this.trie.insert(this.converter(e),void 0))}entries(){return Gt.sequence(this.trie.entries(),tr.map((([e,t])=>Ci(e.join(""),t))))}keys(){return Gt.sequence(this.entries(),tr.map((([e])=>e)))}values(){return Gt.sequence(this.entries(),tr.map((([,e])=>e)))}get height(){return this.trie.height}search(e,t){const r=Fi.create(this.converter(e),this.comparator);return zt.single(this.trie.children.entries(),tr.reduce(((e,[n,i])=>e.concat(Mi(i,n,r,t))),[]))}}t([v.lazy],Ni.prototype,"isEmpty",null),t([v.lazy],Ni.prototype,"height",null);var Li=Ni;function Mi(e,t,r,n){const i=r.next(t),s=[];return i.distance<=n&&e.value&&s.push({value:e.value,distance:i.distance}),i.minimal<=n?zt.single(e.children.entries(),tr.reduce(((e,[t,r])=>e.concat(Mi(r,t,i,n))),s)):s}Ai.PrefixTree=Li;class Fi{constructor(e,t,r){this.keys=e,this.values=t,this.comparator=r}static create(e,t){const r=[];for(let t=0;t<=e.length;t++)r[t]=t;return new Fi(e,r,t)}next(e){const t=this.keys.reduce(((t,r,n)=>(t[n+1]=0===this.comparator(r,e)?this.values[n]:1+Math.min(t[n],this.values[n],this.values[n+1]),t)),[this.values[0]+1]);return new Fi(this.keys,t,this.comparator)}get distance(){return this.values[this.keys.length]}get minimal(){return Math.min(...this.values)}}Di=Fi,Ai.Row=Di;var $i={};Object.defineProperty($i,"__esModule",{value:!0});var Ri=(Ki=void 0,$i.flatten=Ki);$i.unique=Ri;var Ki=function(e){return e.reduce(((e,t)=>e.concat(t)),[])};$i.flatten=Ki;const qi="function"==typeof Set&&1===new Set([1]).size;Ri=function(e){if("function"==typeof Array.from&&qi)return Array.from(new Set(e));const t=[];for(const r of e)t.indexOf(r)<0&&t.push(r);return t},$i.unique=Ri;var _i={};Object.defineProperty(_i,"__esModule",{value:!0});var Ui=void 0;_i.PreferredCurrencies=Ui;class Bi{static dollarSymbol(e){return e&&Bi.dollarCountries[e]||"USD"}static poundSymbol(e){return e&&Bi.poundCountries[e]||"GBP"}static yenSymbol(e){return e&&Bi.yenCountries[e]||"JPY"}static kroneSymbol(e){return e&&Bi.kroneCountries[e]||"DKK"}static rupeeSymbol(e){return e&&Bi.rupeeCountries[e]||"INR"}static for(e){return[Bi.dollarSymbol(e),Bi.poundSymbol(e),Bi.yenSymbol(e),Bi.kroneSymbol(e),Bi.rupeeSymbol(e)]}}Ui=Bi,_i.PreferredCurrencies=Ui,Bi.dollarCountries={AG:"XCD",AU:"AUD",BS:"BSD",BB:"BBD",BZ:"BZD",BM:"BMD",BN:"BND",CA:"CAD",DM:"XCD",EC:"USD",FM:"USD",KY:"KYD",FJ:"FJD",GD:"XCD",GY:"GYD",HK:"HKD",JM:"JMD",KI:"AUD",KN:"XCD",LC:"XCD",LR:"LRD",MH:"USD",NA:"NAD",NZ:"NZD",SG:"SGD",SB:"SBD",SR:"SRD",SV:"USD",TL:"USD",TW:"TWD",TT:"TTD",TV:"AUD",US:"USD",VC:"XCD",ZW:"USD"},Bi.poundCountries={EG:"EGP",FK:"FKP",GB:"GBP",GI:"GIP",GG:"GBP",IM:"GBP",JE:"GBP",LB:"LBP",SH:"SHP",SS:"SSP",SD:"SDG",SY:"SYP"},Bi.yenCountries={CN:"CNY",JP:"JPY"},Bi.kroneCountries={DK:"DKK",FO:"DKK",GL:"DKK",IS:"ISK",NO:"NOK",SE:"SEK"},Bi.rupeeCountries={IN:"INR",ID:"IDR",MU:"MUR",NP:"NPR",PK:"PKR",LK:"LKR"};var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});var Hi=(zi=void 0,Wi.identity=zi);Wi.get=Hi;var zi=function(){return e=>e};Wi.identity=zi,Hi=function(e,t){try{const r=e();return void 0===r?t:r}catch(e){return t}},Wi.get=Hi;class Vi{constructor(e){this.regex=e}parse(e){const t=this.regex.match(e);if(0===t.length)throw new Error(`Generated regex ${this.regex.pattern} did not match "${e}" `);return t}parseAll(e){return zt.array(this.regex.exec(e))}}var Gi=Vi;ri.NamedRegexParser=Gi;var Yi=function(e){return new Vi(e)};ri.namedRegexParser=Yi;class Ji{constructor(e,t){this.delegate=e,this.mapper=t}parse(e){return this.delegate.parse(this.mapper(e))}parseAll(e){return this.delegate.parseAll(this.mapper(e))}}var Xi=Ji;ri.PreProcessor=Xi;var Zi=function(e,t){return new Ji(e,t)};ri.preProcess=Zi;class Qi{constructor(e,t){this.parser=e,this.mapper=t}parse(e){return this.mapper(this.parser.parse(e))}parseAll(e){return e?zt.array(this.parser.parseAll(e),tr.flatMap((e=>{try{return[this.mapper(e)]}catch(e){return[]}}))):[]}}var es=Qi;ri.MappingParser=es;var ts=function(e,t){return new Qi(e,t)};ri.mappingParser=ts;class rs{constructor(e,t=Ai.DEFAULT_COMPARATOR){this.data=e,this.prefixTree=this.data.reduce(((e,t)=>{const r=e.lookup(t.name)||[];return r.push(t),e.insert(t.name,r)}),new Ai.PrefixTree(void 0,t))}parse(e,t=is){const r=t(this.prefixTree,e);if(void 0===r)throw new Error(`${this.constructor.name} - Unable to parse: ${e}`);return r}get pattern(){const{min:e,max:t}=this.minMax;return`[${this.characters.join("")}]{${e},${t}}`}get minMax(){return this.data.reduce((({min:e,max:t},r)=>{const n=ii.characters(r.name).length;return{min:Math.min(e,n),max:Math.max(t,n)}}),{min:Number.MAX_VALUE,max:Number.MIN_VALUE})}get characters(){return $i.unique($i.flatten(this.data.map((e=>e.name)).map(ii.characters))).sort()}}var ns=rs;function is(e,t){const r=$i.flatten(e.match(t)),n=$i.unique(r.map((e=>e.value)));if(1==n.length)return n[0]}ri.DatumLookup=ns;var ss=is;function as(...e){if(0!==e.filter(Boolean).length)return(t,r)=>{const n=t.lookup(r)||[],i=$i.unique(n.map((e=>e.value)));if(0===i.length)return;if(1===i.length)return i[0];const[s]=i.filter((t=>-1!==e.indexOf(t)));return s}}ri.uniqueMatch=ss;var os=as;ri.prefer=os;var cs=function(e){const[,t]=function(e){return e?e.split(/[-_]/).filter(Boolean):[]}(e);return as(..._i.PreferredCurrencies.for(t))};ri.infer=cs;class us{constructor(e){this.parsers=e}parse(e){for(const t of this.parsers)try{const r=t.parse(e);if(r)return r}catch(e){}throw new Error("Unable to value: "+e)}parseAll(e){for(const t of this.parsers){const r=t.parseAll(e);if(r.length>0)return r}return[]}}var ls=us;function ds(...e){return new us(e)}ri.OrParser=ls;var hs=ds;ri.or=hs;var ps=function(...e){return ds(...e)};ri.parsers=ps;class fs{constructor(e){this.parsers=e}parse(e){throw new Error("Not supported, please call AllParser.parseAll")}parseAll(e){return $i.flatten(this.parsers.map((t=>t.parseAll(e))))}}var ys=fs;ri.AllParser=ys;var ms=function(...e){return new fs(e)};ri.all=ms;class gs{constructor(e){this.parser=e}parse(e){return this.parser.parse(e)}parseAll(e){return this.parser.parseAll(e)}}t([y.cache],gs.prototype,"parse",null),t([y.cache],gs.prototype,"parseAll",null);var vs=gs;ri.CachingParser=vs;var ws=",.";ri.boundaryDelimiters=ws;var bs=function(e){return`(?:^|\\s)${e}(?=[\\s${ri.boundaryDelimiters}]|$)`};ri.atBoundaryOnly=bs;class ks extends rs{constructor(e,t){super(e),this.locale=t}static get(e,t=[]){return ks.cache[e]=ks.cache[e]||ks.create(e,t)}static create(e,t=[]){return new ks([...ks.generateData(e),...t],e)}static generateData(e){const t=ri.numberFormatter(e).format(1234567890).replace(/[,. '٬٫]/g,"");return zt.array(ii.characters(t),tr.zip([1,2,3,4,5,6,7,8,9,0]),tr.map((([e,t])=>({name:e,value:t}))))}parse(e){const t=qs(e);return isNaN(t)?super.parse(e):t}format(e){return ri.numberFormatter(this.locale).format(e)}}var Os=ks;ri.Numerals=Os,ks.cache={};var Ss=y.caching((e=>new Intl.NumberFormat(e,{useGrouping:!1})));function As(e){return"\\d"+ks.get(e).characters.join("")}ri.numberFormatter=Ss;var Ds=As;ri.digits=Ds;class Ps{static handle(e){return-1!=Ps.codes.indexOf(e)?Ps.spaces:e}}var xs=Ps;ri.Spaces=xs,Ps.codes=[32,160,8239].map((e=>String.fromCharCode(e))),Ps.spaces=Ps.codes.join(""),Ps.pattern=new RegExp(`[${Ps.spaces}]`,"g");const js="٬٫,.'’‘"+Ps.spaces;var Ts=y.caching((e=>{const t=As(e);return`-?(?:[${t}]+[${js}])*[${t}]+`}));function Cs(e){return tr.flatMap((t=>{try{return[e(t)]}catch(e){return[]}}))}ri.numberPattern=Ts;var Es=Cs;ri.mapIgnoreError=Es;const Is=ii.NamedRegExp.create(`(?<separator>[${js}])`);function Ns(e){return zt.array(Is.exec(e),tr.map((([e])=>e.value)))}var Ls=Ns;ri.separatorsOf=Ls;class Ms{constructor(e,t){this.decimalSeparator=e,this.locale=t,this.strictNumberPattern=new RegExp(`^${ri.numberPattern(t)}$`),this.globalNumberPattern=ii.NamedRegExp.create(`(?<number>${ri.numberPattern(t)})`,"g")}parse(e){if(!this.strictNumberPattern.test(e))throw new Error(`Unable to parse '${e}'`);return this.parseSingle(e)}parseAll(e){return zt.array(this.globalNumberPattern.exec(e),Cs((([e])=>this.parseSingle(e.value.trim()))))}parseSingle(e){const t=Ns(e);if(0===t.length)return this.numberOf(e);const r=t[t.length-1]===this.decimalSeparator?t.slice(0,t.length-1):t;if(-1!==r.indexOf(this.decimalSeparator))throw new Error(`Unable to parse '${e}'`);if($i.unique(r).length>1)throw new Error(`Unable to parse '${e}'`);return this.numberOf(e)}convert(e){const t=ks.get(this.locale);return ii.characters(e).map((e=>{if(e===this.decimalSeparator)return".";if("-"===e)return"-";const r=Wi.get((()=>t.parse(e)));return isNaN(r)?"":r.toString()})).join("")}numberOf(e){const t=qs(this.convert(e));if(isNaN(t))throw new Error(`Unable to parse '${e}'`);return t}}var Fs=Ms;ri.NumberParser=Fs;var $s,Rs,Ks=function(e,t="en"){return new Ms(e,t)};function qs(e){return e&&0!==e.trim().length?Number(e):NaN}ri.numberParser=Ks,ni=qs,ri.numberOf=ni;class _s{constructor(e){this.storage=e}get(e){const t=this.storage.getItem(e);if(t)return ge(t)}set(e,t){return this.storage.setItem(e,JSON.stringify(t)),this}clear(){this.storage.clear()}}class Us{constructor(e){this.stores=e}clear(){this.stores.forEach((e=>e.clear()))}get(e){for(const t of this.stores)try{const r=t.get(e);if(r)return r}catch(e){}}set(e,t){return this.stores.forEach((r=>r.set(e,t))),this}}class Bs{constructor(e){this.storage=e}static create(e){return new Bs(new Us([new _s(e.sessionStorage),Bs.backupStorage]))}add(e){const t=this.data();return t.unshift(e),this.storage.set(Bs.previousPages,d.limit(t,10)),e}last(){const[e]=this.data();return e}data(){return this.storage.get(Bs.previousPages)||[{type:W.Unknown}]}find(e){return d.Arrays.find(this.data(),e)}clear(){this.storage.clear()}}Bs.previousPages="triptease.integration.previous-pages",Bs.backupStorage=new class{constructor(){this.data=new Map}get(e){return this.data.get(e)}set(e,t){return this.data.set(e,t)}clear(){this.data.clear()}};class Ws{constructor(e){this.logger=e,this.workers={}}createWorker(e,t){return n(this,void 0,void 0,(function*(){const r=this.workers[e];return r||(this.workers[e]=yield this.create(t,{name:e}))}))}create(e,t){return n(this,void 0,void 0,(function*(){try{return new Worker(e,t)}catch(r){this.logger.debug("Failed to create Worker switching to Blob Worker because:",r.message);const i=`location.originalHref = "${e}";\n`,s=(yield function(e){return n(this,void 0,void 0,(function*(){if("undefined"!=typeof fetch){const t=yield fetch(e.url,{method:e.method,headers:e.headers,body:e.body,credentials:e.options&&e.options.credentials?"include":"omit"});return{status:t.status,statusDescription:t.statusText,body:yield t.text()}}{const t=new XMLHttpRequest;return t.open(e.method,e.url,!0),e.headers&&Object.keys(e.headers).forEach((r=>{t.setRequestHeader(r,e.headers[r])})),e.options&&e.options.credentials&&(t.withCredentials=!0),t.send(e.body),new Promise(((e,r)=>{t.addEventListener("load",(r=>{e({status:t.status,statusDescription:t.statusText,body:t.responseText})})),t.addEventListener("error",(e=>{r(e)}))}))}}))}({method:"GET",url:e})).body,a=new Blob([i,s],{type:"application/javascript"});return new Worker(URL.createObjectURL(a),t)}}))}}class Hs{constructor(e,t=_("application-starter"),r=new Ws(t),n=new zs(e,t)){this.window=e,this.logging=t,this.workerFactory=r,this.waiter=n}start(e){return n(this,void 0,void 0,(function*(){this.logging.debug(`ApplicationStarter starting app "${e.name}" (${e.type}), ${e.url}`);const t=this.window.document;if("worker"===e.type){const t=yield this.workerFactory.createWorker(e.name,e.url);return e.startMessage&&(yield this.waiter.waitForMessage(e.startMessage,t)),this.logging.debug("ApplicationStarter returning worker"),t}const r=t.createElement(e.type);r.setAttribute("name",e.name),r.src=e.url;const n=Hs.DefaultOptions[e.type]||{};return Object.keys(n).forEach((e=>{r.setAttribute(e.toLowerCase(),n[e])})),this.addElement(r),e.startMessage?yield this.waiter.waitForMessage(e.startMessage):"script"===e.type&&(yield this.waiter.waitForLoadEvent(r)),r}))}addElement(e){(this.window.document.body||this.window.document.documentElement).appendChild(e)}static create(e){var t;const r=P(e).triptease.onboard;return r.applicationStarter=null!==(t=r.applicationStarter)&&void 0!==t?t:new Hs(e)}}Hs.DefaultOptions={script:{defer:"",async:"",crossOrigin:"anonymous"},iframe:{style:"display: none;",sandbox:"allow-scripts allow-same-origin",title:"blank","aria-hidden":"true"}},t([y.cache,r("design:type",Function),r("design:paramtypes",["function"==typeof($s=void 0!==G&&G.ClientSideApplication)?$s:Object]),r("design:returntype","function"==typeof(Rs="undefined"!=typeof Promise&&Promise)?Rs:Object)],Hs.prototype,"start",null);class zs{constructor(e,t){this.window=e,this.logging=t}waitForLoadEvent(e){return this.logging.debug("MessageWaiter waiting for load/error event for",e),new Promise(((t,r)=>{e.addEventListener("load",t),e.addEventListener("error",(()=>r({name:"ScriptError",message:`Failed to load script "${e.src}"`})))}))}waitForMessage(e,t=this.window){return this.logging.debug("MessageWaiter waiting for message",e),new Promise((r=>{this.logging.debug("MessageWaiter creating handler");const n=i=>{try{const s=i.data&&i.data.type,a=s===e;this.logging.debug(`ApplicationStarter message received "${s}", expecting "${e}", matched: ${a}`),a&&(t.removeEventListener("message",n),r(i.data))}catch(e){this.logging.debug("ApplicationStarter error in parsing message",e,i)}};this.logging.debug("MessageWaiter adding listener"),t.addEventListener("message",n)}))}}class Vs{constructor(e,t,r=_("integration-executor"),n=Hs.create(e)){this.window=e,this.kernel=t,this.logger=r,this.starter=n}loadApplications(e){return n(this,void 0,void 0,(function*(){const t=function(e){const t=$(e,"triptease-applications")||"auto";return d.get((()=>{const[t]=Ie.find(e.document),{applications:r}=h(t.query);return r}),t).toLowerCase()}(this.window);if("none"===t)return this.logger.log('applications set to "none", skipping loading'),{};const{integrationId:r,clientKey:n,apiKey:i}=e,{applications:s}=yield this.kernel.applicationConfig({integrationId:r,clientKey:n,apiKey:i}),a="auto"===t?s:s.filter((e=>e.name.toLowerCase()===t)),o=a.filter(Z);return this.logger.log("load applications",o),yield Promise.all(o.map((e=>d.get((()=>this.starter.start(e)))))),a.reduce(((e,t)=>(e[t.name]=!0,e)),{})}))}static create(e,t){var r;const n=P(e).triptease.onboard;return n.applicationLoader=null!==(r=n.applicationLoader)&&void 0!==r?r:new Vs(e,t)}}class Gs{reset(){}summarise(){return{}}timeAsync(e,t){return t()}timeCall(e,t){return t}timeSync(e,t){return t()}}class Ys{constructor(e=[],t=new ot){this.timings=e,this.timers=t}timeCall(e,t){const r=this;return function(...n){const i=performance.now(),s=t.apply(this,n),a=performance.now()-i;return r.timings.push({name:e,time:a}),s}}timeSync(e,t){const r=performance.now(),n=t(),i=performance.now()-r;return this.timings.push({name:e,time:i}),n}timeAsync(e,t){return n(this,void 0,void 0,(function*(){const r=performance.now(),n=yield this.timers.task(t),i=performance.now()-r;return this.timings.push({name:e,time:i}),n}))}summarise(){const e=this.timings.reduce(((e,{name:t,time:r})=>{const n=e[t]||{count:0,avg:0,sum:0,min:Number.MAX_VALUE,max:Number.MIN_VALUE};return n.count++,n.min=Math.min(n.min,r),n.max=Math.max(n.max,r),n.sum+=r,n.avg+=(r-n.avg)/n.count,e[t]=n,e}),{});return this.reset(),e}reset(){this.timings.length=0}}const Js=_("messaging");class Xs{constructor(e){this.messageHandler=e,this.promises=new Map,e&&e.addListener((e=>{if((t=e)&&"object"==typeof t&&"triptease.onboard.response"===t.type&&"string"==typeof t.correlationId){const{correlationId:t}=e,r=this.promises.get(t);r&&(Js.debug("Sender matched response",e),r.resolve(e),this.promises.delete(t))}var t}))}handle(e){return n(this,void 0,void 0,(function*(){return Js.debug("Sending request",e),this.messageHandler&&this.messageHandler.send(e),new Promise(((t,r)=>{this.promises.set(e.correlationId,{resolve:t,reject:r})}))}))}}function Zs(e,t=new ot){return n(this,void 0,void 0,(function*(){const r=e[e.GoogleAnalyticsObject||"ga"];return"function"!=typeof r?[]:d.getAsync((()=>n(this,void 0,void 0,(function*(){const e=new Promise((e=>r((()=>e(d.Arrays.unique(r.getAll().map((e=>e.get("trackingId")))))))));return yield Promise.race([e,t.delay(50).then((()=>[]))])}))))}))}function Qs(e){return d.Arrays.unique(Array.from(e.document.querySelectorAll("script[src*=googletagmanager]")).map((e=>{const{query:t}=new p(e.src),{id:r}=h(t);return r})))}const ea=_("integration-executor");function ta(e){if(!e)return{};const t=Object.assign({},e);return delete t.ratesModified,t}const ra=["fetch","Set","Map","WebAssembly.constructor","Date","Intl.Collator","Intl.NumberFormat","Intl.NumberFormat.prototype.formatToParts","Intl.DateTimeFormat","Intl.DateTimeFormat.prototype.formatToParts","console.log"];var na={};Object.defineProperty(na,"__esModule",{value:!0});var ia=(sa=void 0,na.SystemClock=sa);na.StoppedClock=ia;var sa=class{now(){return new Date}};na.SystemClock=sa;ia=class{constructor(e){this.value=e}now(){return this.value}},na.StoppedClock=ia;var aa={};Object.defineProperty(aa,"__esModule",{value:!0});var oa={};Object.defineProperty(oa,"__esModule",{value:!0});var ca=(ua=void 0,oa.date=ua);oa.defaultOptions=ca;var ua=function(e,t,r){if(t&&(t<1||t>12))throw new Error("Invalid month "+t);if(r&&(r<1||r>31))throw new Error("Invalid day "+r);const n=new Date(Date.UTC(e,t?t-1:0,r||1));if(e!==n.getUTCFullYear())throw new Error("Invalid year "+e);if(t&&t!==n.getUTCMonth()+1)throw new Error("Invalid month "+t);if(r&&r!==n.getUTCDate())throw new Error("Invalid day "+r);return n};oa.date=ua,ca={year:"numeric",month:"numeric",day:"numeric",weekday:"long"},oa.defaultOptions=ca,s(oa,aa);var la={};Object.defineProperty(la,"__esModule",{value:!0});var da=(pa=void 0,ya=la.Formatters=pa,ma=la.ImprovedDateTimeFormat=ya,va=la.format=ma,wa=la.SimpleFormat=va,ba=la.hasNativeToParts=wa,la.formatData=ba);la.DateParts=da;class ha{static create(e,t=aa.defaultOptions){return"string"==typeof t?new ga(e,t):new fa(e,t)}static isNativelySupported(e,t=aa.defaultOptions){const r=this.dateTimeFormat(e,t);return"function"==typeof r.formatToParts&&r.formatToParts(new Date).length>0}static dateTimeFormat(e,t){return new Intl.DateTimeFormat(e,Object.assign(Object.assign({},t),{timeZone:"UTC"}))}}t([y.cache],ha,"create",null),t([y.cache],ha,"isNativelySupported",null);var pa=ha;la.Formatters=pa;class fa{constructor(e,t,r=fa.create(e,t)){this.locale=e,this.options=t,this.delegate=r}static create(e,t){const r=Object.assign({},t),n=Object.keys(r).length,i=ha.dateTimeFormat(e,r);if(Object.keys(r).length!=n)throw new Error("Unsupported DateTimeFormat options provided: "+JSON.stringify(t));return i}format(e){return ii.characters(this.delegate.format(e)).join("")}formatToParts(e=new Date){return ha.isNativelySupported(this.locale,this.options)?this.delegate.formatToParts(e):ka.create(this.locale,this.options).toParts("number"==typeof e?new Date(e):e)}resolvedOptions(){return this.delegate.resolvedOptions()}}var ya=fa;la.ImprovedDateTimeFormat=ya;var ma=function(e,t,r=aa.defaultOptions){if(null==e)throw new Error("Date format requires a value");return ha.create(t,r).format(e)};la.format=ma;class ga{constructor(e,t){this.locale=e,this.value=t,this.partsInOrder=aa.partsFrom(t),this.options=aa.optionsFrom(this.partsInOrder)}format(e){return this.formatToParts(e).map((e=>e.value)).join("")}formatToParts(e=new Date){const t="number"==typeof e?new Date(e):e,r=ka.create(this.locale,this.options).toParts(t);return this.partsInOrder.map((e=>({type:e.type,value:this.valueFor(r,e.type,e.value)})))}valueFor(e,t,r){return"literal"===t?r:aa.valueFromParts(e,t)}resolvedOptions(){return Object.assign(Object.assign({},this.options),{locale:this.locale})}}var va=ga;la.SimpleFormat=va;var wa="function"==typeof Intl.DateTimeFormat.prototype.formatToParts;la.hasNativeToParts=wa;var ba=function(e,t,r=aa.defaultOptions,n=la.hasNativeToParts){const i=ha.create(t,r);return n?i.formatToParts(e):ka.create(t,r).toParts(e)};la.formatData=ba;class ka{constructor(e,t=aa.defaultOptions,r=3333,n=11,i=20,s=5,a=ri.Numerals.get(e)){this.locale=e,this.options=t,this.yearValue=r,this.monthValue=n,this.dayValue=i,this.weekdayValue=s,this.numerals=a}static create(e,t=aa.defaultOptions){return new ka(e,t)}get formatter(){return ha.create(this.locale,this.options)}get formatted(){return this.formatter.format(aa.date(this.yearValue,this.monthValue,this.dayValue))}get months(){return aa.Months.create(this.locale,aa.Months.dataFor(this.locale,this.options,!1))}get month(){return aa.months(this.locale,this.options,!1)[this.monthValue-1]}get weekdays(){return new aa.Weekdays(aa.Weekdays.dataFor(this.locale,this.options,!1))}get weekday(){return aa.weekdays(this.locale,this.options,!1)[this.weekdayValue-1]}get year(){return this.numerals.format(this.yearValue)}get day(){return this.numerals.format(this.dayValue)}get learningNamesPattern(){const e=e=>`(?<${e}>${this[e]})`,t=`(?:${Object.keys(this.options).map((t=>e(t))).join("|")})`;return ii.NamedRegExp.create(t)}get actualNamesPattern(){const e=ri.digits(this.locale),t=this.learningNamesPattern,r="^"+zt.array(t.iterate(this.formatted),tr.map((t=>{if(!ii.isNamedMatch(t))return`(?<literal>[${t}]+?)`;{let[r]=t.filter((e=>Boolean(e.value))).map((e=>e.name));if(!r)throw new Error;if("year"==r)return`(?<year>[${e}]{4})`;if("day"==r)return`(?<day>[${e}]{1,2})`;if("month"==r)return`(?<month>(?:[${e}]{1,2}|${this.months.pattern}))`;if("weekday"==r)return`(?<weekday>${this.weekdays.pattern})`}}))).join("")+"$";return ii.NamedRegExp.create(r)}toParts(e){const t=this.actualNamesPattern,r=this.formatter.format(e),n=t.match(r);if(0===n.length)throw new Error(`${t} did not match ${r}`);const i=n.map((e=>({type:this.getType(e.name,e.value),value:e.value})));return this.collapseLiterals(i)}collapseLiterals(e){for(let t=0;t<e.length;t++){const r=e[t];if("literal"===r.type){let n=t+1;for(;;){const t=e[n];if(!t||"literal"!==t.type)break;r.value=r.value+t.value,e.splice(n,1)}}}return e}getType(e,t){return"month"===e||"weekday"===e?this.parsable(this.months,t)?"month":this.parsable(this.weekdays,t)?"weekday":"literal":e}parsable(e,t){try{return Boolean(e.parse(t))}catch(e){return!1}}}t([v.lazy],ka.prototype,"formatter",null),t([v.lazy],ka.prototype,"formatted",null),t([v.lazy],ka.prototype,"months",null),t([v.lazy],ka.prototype,"month",null),t([v.lazy],ka.prototype,"weekdays",null),t([v.lazy],ka.prototype,"weekday",null),t([v.lazy],ka.prototype,"year",null),t([v.lazy],ka.prototype,"day",null),t([v.lazy],ka.prototype,"learningNamesPattern",null),t([v.lazy],ka.prototype,"actualNamesPattern",null),t([y.cache],ka,"create",null),da=ka,la.DateParts=da,s(la,aa);var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});var Sa=(Aa=void 0,Pa=Oa.parse=Aa,ja=Oa.RegexBuilder=Pa,Ca=Oa.escapeCharacters=ja,Ia=Oa.DateParser=Ca,La=Oa.DateTimeFormatPartParser=Ia,Fa=Oa.dateFrom=La,Ra=Oa.DefaultDateFactory=Fa,qa=Oa.Pivot=Ra,Ua=Oa.SmartDate=qa,Wa=Oa.Days=Ua,Ha=Oa.formatFrom=Wa,Va=Oa.formatRegex=Ha,Ya=Oa.partsFrom=Va,Xa=Oa.optionsFrom=Ya,Za=Oa.formatBuilder=Xa,eo=Oa.defaultParserOptions=Za,ro=Oa.parser=eo,Oa.simpleParser=ro);Oa.localeParser=Sa;var Aa=function(e,t,r,n=aa.hasNativeToParts){return Qa(t,r,n).parse(e)};Oa.parse=Aa;class Da{constructor(e,t=aa.defaultOptions,r){this.locale=e,this.options=t,this.formatted=r}static create(e,t=aa.defaultOptions,r=aa.hasNativeToParts){return"string"==typeof t?Ja(e,t):"string"==typeof t.format?Ja(e,t.format):new Da(e,t,aa.formatData(new Date,e,t,r))}get pattern(){const e=this.formatted.map(((e,t)=>{switch(e.type){case"year":return`(?<year>[${ri.digits(this.locale)}]{${this.lengthOf(e.value)}})`;case"month":return`(?<month>${this.monthsPattern()})`;case"day":return`(?<day>[${ri.digits(this.locale)}]{1,2})`;case"weekday":return`(?<weekday>${aa.Weekdays.get(this.locale).pattern.toLocaleLowerCase(this.locale)})`;default:return`[${$i.unique(ii.characters(this.addExtraLiterals(e))).join("").replace(" ","\\s")}]${t===this.formatted.length-1?"*":"+"}?`}})).join("");return ri.atBoundaryOnly(e)}lengthOf(e){return 2===e.length||"2-digit"===e?2:4}addExtraLiterals(e){return this.options.format?e.value:e.value+(this.options.separators||xa(" ,.-/"))}monthsPattern(){const e=`[${ri.digits(this.locale)}]{1,2}`,t=aa.Months.get(this.locale).pattern.toLocaleLowerCase(this.locale);return"2-digit"===this.options.month||"numeric"===this.options.month?e:"short"===this.options.month||"long"===this.options.month?t:`(?:${e}|${t})`}}t([v.lazy],Da.prototype,"pattern",null),t([y.cache],Da,"create",null);var Pa=Da;function xa(e){return e.replace(/[\-]/g,"\\$&")}Oa.RegexBuilder=Pa;var ja=xa;Oa.escapeCharacters=ja;class Ta{static create(e,t=aa.defaultOptions,r=aa.hasNativeToParts){const n=Da.create(e,t,r).pattern;return ri.mappingParser(Ea.create(ii.NamedRegExp.create(n),e),(r=>Na(r,e,"object"==typeof t?t:void 0)))}}t([y.cache],Ta,"create",null);var Ca=Ta;Oa.DateParser=Ca;class Ea{static create(e,t){return ri.preProcess(ri.mappingParser(ri.namedRegexParser(e),(e=>this.convert(e,t))),(e=>this.preProcess(e,t)))}static convert(e,t){return e.map((e=>({type:e.name,value:e.value.toLocaleUpperCase(t)})))}static preProcess(e,t){return e.toLocaleLowerCase(t)}}t([y.cache],Ea,"create",null);var Ia=Ea;function Na(e,t,r){const n=ri.numberParser(".",t),[i]=e.filter((e=>"day"===e.type));if(!i)throw new Error("No day found");const s=n.parse(i.value),[a]=e.filter((e=>"month"===e.type));if(!a)throw new Error("No month found");const o=aa.Months.get(t).parse(a.value),[c]=e.filter((e=>"year"===e.type)),u=c?n.parse(c.value):void 0;return Wi.get((()=>r.factory),new Ma).create(u,o,s)}Oa.DateTimeFormatPartParser=Ia;var La=Na;Oa.dateFrom=La;class Ma{create(e,t,r){if(void 0===e)throw new Error("No year found");return aa.date(e,t,r)}}var Fa=Ma;Oa.DefaultDateFactory=Fa;class $a{constructor(e){this.pivotYear=e}static on(e){return new $a(e)}static sliding(e,t=new na.SystemClock){const r=t.now();return $a.on(r.getUTCFullYear()+e)}create(e,t,r){if(void 0===e)throw new Error("No year found");if(e>=100)return aa.date(e,t,r);const n=e+100*Math.floor(this.pivotYear/100)-(e<=this.pivotYear%100?0:100);return aa.date(n,t,r)}}var Ra=$a;Oa.Pivot=Ra;class Ka{constructor(e=new na.SystemClock){this.clock=e}create(e,t,r){const n=_a.startOf(this.clock.now());if(void 0===e){const e=aa.date(n.getUTCFullYear(),t,r);return e<n&&e.setUTCFullYear(e.getUTCFullYear()+1),e}return $a.sliding(Ka.windowSize,this.clock).create(e,t,r)}}var qa=Ka;Oa.SmartDate=qa,Ka.windowSize=50;class _a{static startOf(e){return aa.date(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate())}}var Ua=_a;function Ba(e,t){if("year"===e){if(4===t)return"numeric";if(2===t)return"2-digit"}if("month"===e){if(4===t)return"long";if(3===t)return"short";if(2===t)return"2-digit";if(1===t)return"numeric"}if("day"===e){if(2===t)return"2-digit";if(1===t)return"numeric"}if("weekday"===e){if(4===t)return"long";if(3===t)return"short"}throw new Error(`Illegal Argument: ${e} ${t}`)}Oa.Days=Ua;var Wa=Ba;Oa.formatFrom=Wa;var Ha=ii.NamedRegExp.create("(?:(?<year>y+)|(?<month>M+)|(?<day>d+)|(?<weekday>E+))","g");function za(e){return zt.array(Oa.formatRegex.iterate(e),tr.map((e=>{if(ii.isNamedMatch(e)){const[t]=e.filter((e=>Boolean(e.value))),r=t.name;return{type:r,value:Ba(r,t.value.length)}}return{type:"literal",value:e}})))}Oa.formatRegex=Ha;var Va=za;function Ga(e){const t="string"==typeof e?za(e):e,r=["year","month","day","weekday"];return t.filter((e=>-1!=r.indexOf(e.type))).reduce(((e,t)=>(e[t.type]=t.value,e)),"string"==typeof e?{format:e}:{})}Oa.partsFrom=Va;var Ya=Ga;function Ja(e,t){return new Da(e,Ga(t),za(t))}Oa.optionsFrom=Ya;var Xa=Ja;Oa.formatBuilder=Xa;var Za=[{year:"numeric",month:"long",day:"numeric",weekday:"long"},{year:"numeric",month:"short",day:"numeric",weekday:"short"},{year:"numeric",month:"numeric",day:"numeric"},{year:"numeric",month:"short",day:"numeric"},{year:"numeric",month:"long",day:"numeric"}];function Qa(e,t,r=aa.hasNativeToParts){return"string"==typeof t?to(e,t,r):no(e,t,r)}Oa.defaultParserOptions=Za;var eo=Qa;function to(e,t,r=aa.hasNativeToParts){return Ta.create(e,t,r)}Oa.parser=eo;var ro=to;function no(e,t,r=aa.hasNativeToParts){return t?Ta.create(e,t,r):ri.or(...Oa.defaultParserOptions.map((t=>no(e,t,r))))}Oa.simpleParser=ro,Sa=no,Oa.localeParser=Sa,s(Oa,aa);var io={};Object.defineProperty(io,"__esModule",{value:!0});var so=(oo=void 0,ho=io.Months=oo,fo=io.months=ho,mo=io.cleanValue=fo,wo=io.Weekdays=mo,ko=io.weekdays=wo,So=io.exactFormat=ko,Do=io.BaseDataExtractor=So,xo=io.valueFromParts=Do,To=io.NativeDataExtractor=xo,Eo=io.FromFormatStringDataExtractor=To,io.FromFormatStringMonthExtractor=Eo);io.FromFormatStringWeekdayExtractor=so;class ao extends ri.DatumLookup{constructor(e,t){super(e),this.numerals=ri.Numerals.get(t)}parse(e){const t=Wi.get((()=>this.numerals.parse(e)));return isNaN(t)?super.parse(po(e)):t}get characters(){return[...super.characters,"."]}static get(e,t=[]){return ao.cache[e]=ao.cache[e]||ao.create(e,t)}static set(e,t){return ao.cache[e]=t}static create(e,t=[]){return new ao([...ao.generateData(e),...t],e)}static generateData(e){return $i.flatten(ao.formats.map((t=>ao.dataFor(e,t))))}static dataFor(e,t,r=la.hasNativeToParts){return lo(e,t,r).map(((e,t)=>({name:e,value:t+1})))}}var oo=ao;function co(e,t){const r=[];for(let n=e;n<=t;n++)r.push(n);return r}io.Months=oo,ao.formats=[{month:"long"},{month:"short"},{year:"numeric",month:"long",day:"numeric"},{year:"numeric",month:"short",day:"numeric"}],ao.cache={};const uo={};function lo(e,t="long",r=la.hasNativeToParts){const n=JSON.stringify({locale:e,monthFormat:t,native:r});return uo[n]=uo[n]||(()=>{const n=Object.assign({},"string"==typeof t?{month:t}:t);if(!n.month)return[];const i=co(1,12).map((e=>oa.date(2e3,e,1)));return r?new Po(e,n,i,"month").extract().map(po):new Co(e,n,i).extract().map(po)})()}var ho=lo;function po(e){return e.replace(/\.$/,"")}io.months=ho;var fo=po;io.cleanValue=fo;class yo extends ri.DatumLookup{static get(e,t=[]){return yo.cache[e]=yo.cache[e]||yo.create(e,t)}static set(e,t){return yo.cache[e]=t}static create(e,t=[]){return new yo([...yo.generateData(e),...t])}static generateData(e){return $i.flatten(yo.formats.map((t=>yo.dataFor(e,t))))}static dataFor(e,t,r=la.hasNativeToParts){return vo(e,t,r).map(((e,t)=>({name:e,value:t+1})))}}var mo=yo;io.Weekdays=mo,yo.formats=[{weekday:"long"},{weekday:"short"},{year:"numeric",month:"numeric",day:"numeric",weekday:"long"},{year:"numeric",month:"numeric",day:"numeric",weekday:"short"}],yo.cache={};const go={};function vo(e,t="long",r=la.hasNativeToParts){const n=JSON.stringify({locale:e,weekdayFormat:t,native:r});return go[n]=go[n]||(()=>{const n=Object.assign({},"string"==typeof t?{weekday:t}:t);if(!n.weekday)return[];const i=co(1,7).map((e=>oa.date(2e3,1,e+2)));return r?new Po(e,n,i,"weekday").extract():new Io(e,n,i).extract()})()}var wo=vo;function bo(e,t,r){const n=la.Formatters.create(e,t);return r.map((e=>n.format(e)))}io.weekdays=wo;var ko=bo;io.exactFormat=ko;class Oo{constructor(e,t,r,n){this.locale=e,this.options=t,this.dates=r,this.partType=n}}var So=Oo;function Ao(e,t){return e.filter((e=>e.type===t)).map((e=>e.value)).join("")}io.BaseDataExtractor=So;var Do=Ao;io.valueFromParts=Do;class Po extends Oo{extract(){const e=la.Formatters.create(this.locale,this.options);return this.dates.map((t=>Ao(e.formatToParts(t),this.partType)))}}var xo=Po;io.NativeDataExtractor=xo;class jo extends Oo{extract(){const e=1==Object.keys(this.options).length,t=bo(this.locale,this.options,this.dates);if(e)return t;const r=bo(this.locale,{[this.partType]:this.options[this.partType]},this.dates),n=this.diff(t),i=[];for(let e=0;e<r.length;e++){const s=t[e],a=r[e],o=n[e];i.push(-1!=s.indexOf(a)&&a.length>o.length&&isNaN(parseInt(o))?a:o)}return i}diff(e){return ii.different(e)}}var To=jo;io.FromFormatStringDataExtractor=To;class Co extends jo{constructor(e,t,r){super(e,t,r,"month")}diff(e){if(!this.options.weekday)return super.diff(e);const t=[],r=vo(this.locale,this.options,!1),n=r[this.day(this.dates[8])];for(let i=0;i<e.length;i++){const s=this.replaceYearMonthDay(e[i]).replace(this.weekday(r,i),n);t[i]=this.restoreYearMonthDay(s)}return super.diff(t)}weekday(e,t){return e[this.day(this.dates[t])]}replaceYearMonthDay(e){return ii.replace(Co.replaceYMD,e,(e=>{const t=e[1],r=e[2];if("年"===r)return t+"year";if("月"===r)return t+"month";if("日"===r)return t+"day";throw new Error("Unknown delimiter "+r)}))}restoreYearMonthDay(e){return ii.replace(Co.restoreYMD,e,(e=>{const t=e[1];if("year"===t)return"年";if("month"===t)return"月";if("day"===t)return"日";throw new Error("Unknown delimiter "+t)}))}day(e){const t=e.getUTCDay();return 0==t?6:t-1}}var Eo=Co;io.FromFormatStringMonthExtractor=Eo,Co.replaceYMD=/(\d)([年月日])/g,Co.restoreYMD=/(year|month|day)/g;class Io extends jo{constructor(e,t,r){super(e,t,r,"weekday")}diff(e){if(!this.options.day)return super.diff(e);const t=[],r=this.dates[0].getUTCDate().toString();for(let n=0;n<e.length;n++){const i=e[n],s=this.convertToNumeral(this.dates[n].getUTCDate()),a=i.replace(s,r);t[n]=a}return super.diff(t)}convertToNumeral(e){return ri.numberFormatter(this.locale).format(e)}}so=Io,io.FromFormatStringWeekdayExtractor=so,s(io,aa);class $afee76a7240cf1217f3651c0cb0e0e$export$SelfIntegratedRoomsAndRates{constructor(e,t=ri.numberParser("."),r=aa.parser("en","yyyy-MM-dd")){this.browserWindow=e,this.numParser=t,this.dateParser=r}integrationData(){const e=d.Arrays.from(this.browserWindow.document.querySelectorAll(".price-fighter-widget:not(.triptease-managed)"));if(0===e.length)return;const t=e.map((e=>this.cleanData(e))),r=this.createSetsFrom(t);return r.hasUnique("apiKey")||r.hasUnique("propertyCode")?this.singleHotel(t[0]):this.multipleHotels(t,r)}cleanData(e){const t=(l=e.dataset,Object.keys(l).reduce(((e,t)=>{const r=t.replace(/^pf/,"");return Object.assign(Object.assign({},e),{[`${r[0].toLowerCase()}${r.slice(1)}`]:l[t]})}),{})),{clientkey:r,property:n,token:i,hotelkey:s,directPrice:a,roomRate:o,roomType:c}=t,u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["clientkey","property","token","hotelkey","directPrice","roomRate","roomType"]);var l;const d=s||i,h=n?void 0:d,p=r||(n?d:void 0);return Object.assign({clientKey:p,apiKey:h,propertyCode:n,price:a,roomName:c,rateName:o},u)}createSetsFrom(e){return e.reduce(((e,t)=>d.Objects.entries(t).reduce(((e,[t,r])=>e.add(t,r)),e)),new Lo)}singleHotel(e){const t=e.propertyCode?[{identifier:e.propertyCode,type:"Trusted"}]:[],r="true"===e.loggedIn?"untrusted":"none";return d.Objects.removeEmpty({type:W.RoomsAndRates,pageClass:"SelfIntegratedRoomsAndRates",language:e.language,clientKey:e.clientKey,apiKey:e.apiKey,identifiers:t,adults:d.get((()=>this.numParser.parse(e.adults))),children:d.get((()=>this.numParser.parse(e.children))),rooms:d.get((()=>this.numParser.parse(e.rooms))),checkin:d.get((()=>this.dateParser.parse(e.checkin))),checkout:d.get((()=>this.dateParser.parse(e.checkout))),total:e.total?"true"===e.total:void 0,layout:No(e.layout),ratesModified:r,rateDetails:[d.Objects.removeEmpty({price:d.get((()=>this.numParser.parse(e.price))),currency:e.currency,rateName:e.rateName,roomName:e.roomName})]})}multipleHotels(e,t){const r=t.get("total"),n=e.reduce(((e,t)=>e||"true"===t.loggedIn),!1)?"untrusted":"none";return d.Objects.removeEmpty({type:W.RoomsAndRates,pageClass:"SelfIntegratedRoomsAndRates",language:t.get("language"),clientKey:d.get((()=>t.get("clientKey"))),adults:d.get((()=>this.numParser.parse(t.get("adults")))),children:d.get((()=>this.numParser.parse(t.get("children")))),rooms:d.get((()=>this.numParser.parse(t.get("rooms")))),checkin:d.get((()=>this.dateParser.parse(t.get("checkin")))),checkout:d.get((()=>this.dateParser.parse(t.get("checkout")))),total:r?"true"===r:void 0,layout:No(t.get("layout")),ratesModified:n,rateDetails:e.map((e=>{const t=e.propertyCode?[{identifier:e.propertyCode,type:"Trusted",identifierType:"HotelCode"}]:[];return d.Objects.removeEmpty({clientKey:e.clientKey,apiKey:e.apiKey,identifiers:t,price:d.get((()=>this.numParser.parse(e.price))),currency:e.currency,rateName:e.rateName,roomName:e.roomName})}))})}}function No(e){if(e)return e.toLowerCase().replace("-","")}class Lo{constructor(){this.sets={}}hasUnique(e){const t=this.sets[e];return!!t&&1===t.size}add(e,t){return t?(this.sets[e]=this.sets[e]||new Set,this.sets[e].add(t),this):this}get(e){const t=this.sets[e];if(1===t.size)return d.Arrays.from(t)[0]}}class $e587afa93dd082443d18850d31f559d$export$SelfIntegratedConfirmation{constructor(e,t=ri.numberParser(".")){this.window=e,this.parser=t}integrationData(){return d.Arrays.from(this.window.document.querySelectorAll('script[src*="triptease"]')).map((e=>new p(e.src))).reduce(((e,t)=>{const r=h(t.query,!1);return{type:W.Confirmation,price:r.bookingValue?this.parser.parse(r.bookingValue):e.price,currency:r.bookingCurrency?r.bookingCurrency:e.currency,reference:r.bookingReference?r.bookingReference:e.reference,basePrice:r.basePrice?this.parser.parse(r.basePrice):e.basePrice,checkin:r.checkin?new Date(r.checkin):e.checkin,checkout:r.checkout?new Date(r.checkout):e.checkout}}),{})}}class $c497c37e43297f6c12f9edf0b9b5c874$export$StructuredDataRoomsAndRates{find(e){return{search:d.Arrays.find(e,(e=>"LodgingSearch"===e["@type"])),offers:e.filter((e=>"Offer"===e["@type"])),offerCatalog:d.Arrays.find(e,(e=>"OfferCatalog"===e["@type"]))}}convert({search:e,offers:t,offerCatalog:r}){const n=t.map((e=>({price:d.get((()=>Number(e.priceSpecification.price)),0),currency:e.priceSpecification.priceCurrency,rateName:e.name,rateCode:e.identifier,roomName:e.itemOffered.name,roomCode:e.itemOffered.identifier})));return d.Objects.removeEmpty({type:W.RoomsAndRates,checkin:d.get((()=>new Date(e.checkinTime))),checkout:d.get((()=>new Date(e.checkoutTime))),adults:d.get((()=>Number(e.numAdults)),2),children:d.get((()=>Number(e.numChildren)),0),rooms:d.get((()=>Number(e.numRooms)),1),rateDetails:n,ratesModified:d.get((()=>0===Number(r.numberOfItems)))?"noAvailability":void 0,total:d.get((()=>"Total"===t[0].priceSpecification.unitText))})}}class $d799cd473f72d871a7f845a4977$export$StructuredDataConfirmation{constructor(){this.lookup={"http://schema.org/ReservationConfirmed":"confirmed","http://schema.org/ReservationCancelled":"cancelled"}}find(e){return e.filter((e=>X(e)&&this.lookup[e.reservationStatus]))}convert(e){const t=e.map((e=>d.Objects.removeEmpty({reference:e.reservationId,price:Number(e.totalPrice),basePrice:Number(e.basePrice),reservationStatus:this.lookup[e.reservationStatus]}))),[r]=e,{checkinTime:n,checkoutTime:i,priceCurrency:s}=r;return d.Objects.removeEmpty({type:W.Confirmation,pageClass:"StructuredDataConfirmation",checkin:this.parseDate(n),checkout:this.parseDate(i),currency:s,reference:t.map((e=>e.reference)).sort().join(","),price:t.map((e=>e.price)).reduce(Jt.sum),basePrice:t.map((e=>e.basePrice)).reduce(Jt.sum),reservations:t})}parseDate(e){return d.get((()=>{const t=new Date(e);if(!isNaN(t.getTime()))return t}),void 0)}}class $e1b9f39d81fe3b8a13516037726fb9b$export$StructuredDataPage{constructor(e,t=[new $d799cd473f72d871a7f845a4977$export$StructuredDataConfirmation,new $c497c37e43297f6c12f9edf0b9b5c874$export$StructuredDataRoomsAndRates]){this.window=e,this.converters=t,this.logger=_("structured-data")}static confirmation(e){return new $e1b9f39d81fe3b8a13516037726fb9b$export$StructuredDataPage(e,[new $d799cd473f72d871a7f845a4977$export$StructuredDataConfirmation])}static roomsAndRates(e){return new $e1b9f39d81fe3b8a13516037726fb9b$export$StructuredDataPage(e,[new $c497c37e43297f6c12f9edf0b9b5c874$export$StructuredDataRoomsAndRates])}integrationData(){const e=It.processDocument(this.window.document);for(const t of this.converters)try{const r=t.find(e);if(!r)continue;return t.convert(r)}catch(e){}this.logger.log(this.converters.length+" converters were unable to process structured data",{structuredData:e})}}new class{constructor(e,t,r=Ot(e),i=_("integration-executor"),s=new Oe(e),a=new Xs(function(e){const t=function(e){return e.document.querySelector('iframe[name="triptease.onboard.kernel"]')}(e);if(t&&t.contentWindow)return new oe(e,t.contentWindow)}(e)),o=new Pe(a),c=De(a),u=Bs.create(e),l=new Ke(e,u),h=Vs.create(e,o),p=function(){return"object"==typeof performance&&"now"in performance?new Ys:new Gs}()){this.window=e,this.script=t,this.events=r,this.logger=i,this.messageBuilder=s,this.sender=a,this.kernel=o,this.kernelHost=c,this.history=u,this.processor=l,this.applicationLoader=h,this.reporter=p,this.first=!0,this.integrate=()=>n(this,void 0,void 0,(function*(){this.logger.log("Begin integration executor");const e=yield this.reporter.timeAsync("page-scraping",(()=>this.findPageData())),t=yield this.reporter.timeAsync("hotel-identification",(()=>this.addIdentificationData(e)));t.language||(t.language=function(e){return ti.detectLocale(e.document)}(this.window));const r=this.processor.processIntegrationData(t);if(this.logger.log("Processed integration data",r),this.first||!d.same(ta(this.history.last()),ta(r))){this.logger.log("Integration data has changed - updating triptease.config"),this.window.triptease.config=r,this.history.add(r);const e=yield this.reporter.timeAsync("applications-loading",(()=>this.applicationLoader.loadApplications(r)));yield this.sendToKernelHost(yield this.messageBuilder.buildMessage({type:"triptease.config",payload:r,applications:e,context:{app:this.script.app()}})),this.first=!1}else this.logger.log("No change in integration data - doing nothing");return r})),function(e,t){n(this,void 0,void 0,(function*(){const r=P(e).triptease;ea.log(`replaceExecutor old:${d.get((()=>r.integration.script.integrationName))} new:${d.get((()=>t.script.integrationName))}`),r.integration&&(yield r.integration.stop()),r.integration=t,yield t.start()}))}(e,this)}start(){return n(this,void 0,void 0,(function*(){ea.log("IntegrationExecutor.start "+this.script.integrationName),yield this.events.listen(this.integrate)}))}stop(){return n(this,void 0,void 0,(function*(){ea.log("IntegrationExecutor.stop "+this.script.integrationName),this.events.removeListener(this.integrate)}))}addIdentificationData(e){return n(this,void 0,void 0,(function*(){let t=yield new xe([new $e(this.window),new Ne(this.window),this.script,new Re(e)],this.logger).scrapeIdentifiers();if("none"===t.apiKey)return this.logger.log('Skipping identification as apiKey is set to "none" - Only interested in page data for ARI feed'),e;if(this.logger.log("all identifiers",t),re(e)&&Array.isArray(e.rateDetails)){e.rateDetails=yield this.processArrayIdentifiers(e.rateDetails,t);const r=this.getUniqueApiKey(e.rateDetails);r&&(t=Object.assign(Object.assign({},t),{apiKey:r}))}if(ne(e)&&Array.isArray(e.reservations)){e.reservations=yield this.processArrayIdentifiers(e.reservations,t);const r=this.getUniqueApiKey(e.reservations);r&&(t=Object.assign(Object.assign({},t),{apiKey:r}))}if(Ht(t)||Ht(e))this.logger.log("skipping hotel identification scraping as apiKey or identifier already provided");else{const e=new Wt(this.window).scrapeIdentifiers();this.logger.log("hotel identifiers",e),t=Object.assign(Object.assign({},t),e)}const r=yield this.kernel.generateConfig(t);this.logger.log("generatedConfig",r);const{integrationId:n,clientKey:i,clientName:s,apiKey:a}=r||{};return d.Objects.removeEmpty(Object.assign({integrationId:n,clientKey:i,clientName:s,apiKey:a,address:(o=yield t.address,d.Objects.removeEmpty(Object.assign(Object.assign({},o),{lines:d.get((()=>o.lines.filter(Boolean).map(String)))})))},e));var o}))}getUniqueApiKey(e){const t=d.Arrays.unique(e.map((e=>e.apiKey)));if(1===t.length)return t[0]}processArrayIdentifiers(e,t){return n(this,void 0,void 0,(function*(){return yield Promise.all(e.map((e=>n(this,void 0,void 0,(function*(){return Q(e)?Object.assign(Object.assign({},e),yield this.kernel.generateConfig(Object.assign(Object.assign({},t),Te(e)))):e})))))}))}sendToKernelHost(e){return n(this,void 0,void 0,(function*(){this.logger.log("Sending triptease.config message to local kernel host",e);const t=Object.assign(Object.assign({},e),{context:Object.assign(Object.assign({},e.context),{stats:this.reporter.summarise(),google:yield d.getAsync((()=>function(e){return n(this,void 0,void 0,(function*(){return{ga:yield Zs(e),gtm:Qs(e)}}))}(this.window)),{}),features:T(this.window,...ra)})});this.kernelHost.processConfig(t)}))}findPageData(){return n(this,void 0,void 0,(function*(){const e=[];for(const t of this.script.pages)try{const r=yield t.integrationData();if(r&&(r.pageClass=r.pageClass||d.getClassName(t)),te(r))return this.logger.log("Found valid page",r),r;e.push(r)}catch(e){this.logger.debug("Page didn't parse due to error",e)}return this.logger.log("No valid pages found - finding partial page from",e),function(e){const[t]=e.map(d.Objects.removeEmpty).filter(ie);if(t)return Object.assign(Object.assign({},t),{type:W.Partial,partialType:t.type})}(e)||{type:W.Unknown}}))}}(window,new class extends class{constructor(e,t=new na.SystemClock){this.window=e,this.clock=t}scrapeIdentifiers(){return{address:this.address()}}address(){return{}}app(){return{name:this.integrationName,version:pe.get()}}}{constructor(){super(...arguments),this.integrationName="default",this.pages=[$e1b9f39d81fe3b8a13516037726fb9b$export$StructuredDataPage.confirmation(this.window),new $e587afa93dd082443d18850d31f559d$export$SelfIntegratedConfirmation(this.window),$e1b9f39d81fe3b8a13516037726fb9b$export$StructuredDataPage.roomsAndRates(this.window),new $afee76a7240cf1217f3651c0cb0e0e$export$SelfIntegratedRoomsAndRates(this.window)]}scrapeIdentifiers(){return d.Objects.removeEmpty({address:d.get((()=>this.address()))})}address(){const e=It.processDocument(this.window.document),t=function(e){if(e)return{latitude:Number(e.latitude),longitude:Number(e.longitude)}}(Lt(e,"GeoCoordinates")),r=Lt(e,"PostalAddress");return r?d.Objects.removeEmpty({geo:t,lines:[r.streetAddress,r.addressLocality].filter(Boolean),region:r.addressRegion,postalCode:r.postalCode,country:r.addressCountry}):d.Objects.removeEmpty({geo:t})}app(){const e=It.processDocument(this.window.document),t=d.get((()=>{const{name:t,version:r}=e.find((e=>"SoftwareApplication"===e["@type"]));return{name:t,version:String(r)}}),{});return t.name?t:super.app()}}(window))}();